{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jclon/chatgptVcp/Ionic-vcp-macbook27mars22024/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { VillesModalPage } from '../villes-modal/villes-modal.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/user.service\";\nimport * as i3 from \"src/app/services/commerce.service\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"src/app/services/clicked-element.service\";\nimport * as i6 from \"@angular/common\";\nfunction VillesCommercesPage_ion_list_11_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-card\", 2);\n    i0.ɵɵlistener(\"click\", function VillesCommercesPage_ion_list_11_ion_card_1_Template_ion_card_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const commerce_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.navigateToCommerceCategories(commerce_r2.id));\n    });\n    i0.ɵɵelement(1, \"ion-img\", 9);\n    i0.ɵɵelementStart(2, \"ion-card-header\")(3, \"ion-card-title\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-card-subtitle\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"ion-card-content\")(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const commerce_r2 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", commerce_r2.image_commerce);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(commerce_r2.commercename);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(commerce_r2.services);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(commerce_r2.villeName || \"Unknown Ville\");\n  }\n}\nfunction VillesCommercesPage_ion_list_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\");\n    i0.ɵɵtemplate(1, VillesCommercesPage_ion_list_11_ion_card_1_Template, 10, 4, \"ion-card\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.commerces);\n  }\n}\nexport class VillesCommercesPage {\n  constructor(router, userService, commerceService, navCtrl, modalCtrl, cdr, clickedElementService) {\n    this.router = router;\n    this.userService = userService;\n    this.commerceService = commerceService;\n    this.navCtrl = navCtrl;\n    this.modalCtrl = modalCtrl;\n    this.cdr = cdr;\n    this.clickedElementService = clickedElementService;\n    this.villes = [];\n    this.commerces = [];\n    this.selectedVilleId = null;\n    this.showSelectWithVille = true;\n  }\n  ngOnInit() {\n    // Subscribe to changes in commerces array\n    this.commerceService.commerces$.subscribe(commerces => {\n      // Update local commerces array with the new data\n      this.commerces = commerces;\n    });\n    console.log('at the Init : ', this.commerces);\n    this.fetchAndEnhanceCommerces();\n  }\n  // Inside the ngOnInit method of your component\n  fetchAndEnhanceCommerces() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Fetch commerces\n        const commerces = yield _this.commerceService.getAllCommercesBelongingOwnersWithMonthlyFeePaid();\n        // Sort the commerces array by ID in ascending order\n        commerces.sort((a, b) => a.id - b.id);\n        // Enhance commerces array with villeName and business owner information\n        for (const commerce of commerces) {\n          // Get the ville name for the commerce\n          commerce.villeName = yield _this.commerceService.getVilleNameByVilleId(commerce.ville_id);\n          // Get the business owner information for the commerce\n          commerce.businessOwner = yield _this.userService.getBusinessOwnerById(commerce.business_owner_id);\n        }\n        // Now the commerces array is enhanced with villeName and business owner information\n        _this.commerces = commerces;\n      } catch (error) {\n        console.error('Error fetching and enhancing commerces:', error);\n      }\n    })();\n  }\n  goToLoginPage() {\n    // Completely shut down the current page\n    this.destroy();\n    // Navigate to the login page\n    this.router.navigate(['/login']);\n  }\n  destroy() {\n    const element = document.getElementById('villes-commerces-page');\n    if (element) {\n      element.remove();\n    }\n  }\n  search(event) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const query = event?.detail?.value || '';\n      try {\n        // If a search query is provided, filter commerces\n        if (query.trim() !== '') {\n          _this2.commerces = yield _this2.commerceService.searchingCommerces(query);\n          // Enhance the filtered commerces array with villeName and other information\n          for (const commerce of _this2.commerces) {\n            // Get the ville name for the commerce\n            commerce.villeName = yield _this2.commerceService.getVilleNameByVilleId(commerce.ville_id);\n            // Get any additional information you need for the commerce\n            commerce.businessOwner = yield _this2.userService.getBusinessOwnerById(commerce.business_owner_id);\n            // Add more enhancements if needed\n          }\n        } else {\n          // If no search query, fetch and enhance all commerces\n          yield _this2.fetchAndEnhanceCommerces();\n        }\n      } catch (error) {\n        console.error('Error searching commerces:', error);\n      }\n    })();\n  }\n  filterByVilleId(villeId) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Filter commerces by villeId\n        const commerces = yield _this3.commerceService.getCommercesByVilleId1(villeId);\n        // Enhance the filtered commerces array with villeName and other information\n        for (const commerce of commerces) {\n          // Get the ville name for the commerce\n          commerce.villeName = yield _this3.commerceService.getVilleNameByVilleId(commerce.ville_id);\n          // Get any additional information you need for the commerce\n          commerce.businessOwner = yield _this3.userService.getBusinessOwnerById(commerce.business_owner_id);\n          // Add more enhancements if needed\n        }\n        // Sort the commerces array by ID in ascending order\n        commerces.sort((a, b) => a.id - b.id);\n        // Update the commerces array with filtered and enhanced information\n        _this3.commerces = commerces;\n      } catch (error) {\n        console.error('Error filtering commerces by villeId:', error);\n      }\n    })();\n  }\n  clearFilter() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Clear the filter and fetch and enhance all commerces\n        yield _this4.fetchAndEnhanceCommerces();\n        // Reset the selected value in the ion-select\n        _this4.selectedVilleId = null;\n        // Toggle the rendering of ion-select\n        _this4.showSelectWithVille = true;\n      } catch (error) {\n        console.error('Error clearing filter:', error);\n      }\n    })();\n  }\n  openVillesModalPage() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      console.log('this.commerces', _this5.commerces);\n      const villesList = _this5.commerceService.getVillesFromCommerces(_this5.commerces);\n      console.log('villes Liste', villesList);\n      /* const villesList = await this.commerceService.getAllVilles();\n      console.log ('villesList', villesList); */\n      const modal = yield _this5.modalCtrl.create({\n        component: VillesModalPage,\n        componentProps: {\n          villesList: villesList // Pass the list of villes to the modal\n        }\n      });\n\n      modal.onDidDismiss().then(result => {\n        // Handle the result from the modal if needed\n        if (result.data) {\n          // Handle the selected ville\n          _this5.filterByVilleId(result.data);\n        }\n      });\n      return yield modal.present();\n    })();\n  }\n  navigateToCommerceCategories1(commerceId) {\n    const clickedCommerce = this.commerces.find(commerce => commerce.id === commerceId);\n    this.router.navigate(['/category-products', commerceId], {\n      state: {\n        clickedCommerce\n      }\n    });\n  }\n  navigateToCommerceCategories(commerceId) {\n    const clickedCommerce = this.commerces.find(commerce => commerce.id === commerceId);\n    // Set the clickedCommerce in the ClickedElementService\n    this.clickedElementService.setClickedCommerce(clickedCommerce);\n    // Navigate to the category products page\n    this.router.navigate(['/category-products', commerceId]);\n  }\n  static #_ = this.ɵfac = function VillesCommercesPage_Factory(t) {\n    return new (t || VillesCommercesPage)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.CommerceService), i0.ɵɵdirectiveInject(i4.NavController), i0.ɵɵdirectiveInject(i4.ModalController), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i5.ClickedElementService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: VillesCommercesPage,\n    selectors: [[\"app-villes-commerces\"]],\n    decls: 21,\n    vars: 1,\n    consts: [[\"color\", \"primary\"], [\"slot\", \"end\"], [3, \"click\"], [\"color\", \"primary\", 1, \"custom-toolbar\"], [3, \"ionInput\"], [4, \"ngIf\"], [\"size\", \"6\"], [\"expand\", \"full\", 3, \"click\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"alt\", \"Commerce Logo\", 1, \"commerce-image\", 3, \"src\"]],\n    template: function VillesCommercesPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\", 0)(2, \"ion-title\");\n        i0.ɵɵtext(3, \" Villes Commerces \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-buttons\", 1)(5, \"ion-button\", 2);\n        i0.ɵɵlistener(\"click\", function VillesCommercesPage_Template_ion_button_click_5_listener() {\n          return ctx.goToLoginPage();\n        });\n        i0.ɵɵtext(6, \" Login \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(7, \"ion-header\")(8, \"div\", 3)(9, \"ion-searchbar\", 4);\n        i0.ɵɵlistener(\"ionInput\", function VillesCommercesPage_Template_ion_searchbar_ionInput_9_listener($event) {\n          return ctx.search($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(10, \"ion-content\");\n        i0.ɵɵtemplate(11, VillesCommercesPage_ion_list_11_Template, 2, 1, \"ion-list\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"ion-footer\")(13, \"ion-toolbar\")(14, \"ion-row\")(15, \"ion-col\", 6)(16, \"ion-button\", 7);\n        i0.ɵɵlistener(\"click\", function VillesCommercesPage_Template_ion_button_click_16_listener() {\n          return ctx.openVillesModalPage();\n        });\n        i0.ɵɵtext(17, \"Select Ville\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"ion-col\", 6)(19, \"ion-button\", 7);\n        i0.ɵɵlistener(\"click\", function VillesCommercesPage_Template_ion_button_click_19_listener() {\n          return ctx.clearFilter();\n        });\n        i0.ɵɵtext(20, \"Clear Filter\");\n        i0.ɵɵelementEnd()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngIf\", ctx.commerces.length > 0);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i4.IonButton, i4.IonButtons, i4.IonCard, i4.IonCardContent, i4.IonCardHeader, i4.IonCardSubtitle, i4.IonCardTitle, i4.IonCol, i4.IonContent, i4.IonFooter, i4.IonHeader, i4.IonImg, i4.IonList, i4.IonRow, i4.IonSearchbar, i4.IonTitle, i4.IonToolbar, i4.TextValueAccessor],\n    styles: [\".even-item[_ngcontent-%COMP%] {\\n  --ion-item-background: rgb(156, 218, 243);\\n}\\n\\n.odd-item[_ngcontent-%COMP%] {\\n  --ion-item-background: lightpink;\\n}\\n\\n\\n\\nion-item[_ngcontent-%COMP%] {\\n  --ion-item-border-color: #ccc; \\n\\n}\\n\\n\\n\\nion-content[_ngcontent-%COMP%] {\\n  --ion-scrollbar-background: #f0f0f0; \\n\\n  --ion-scrollbar-thumb-background: #999; \\n\\n}\\n\\n\\n\\n.ionSelectRight[_ngcontent-%COMP%] {\\n  --ion-item-end: 0; \\n\\n}\\n\\n\\n\\n.form-buttons[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  gap: 10px; \\n\\n  margin: 10px 0; \\n\\n}\\n\\n\\n\\nbutton.tooltip[_ngcontent-%COMP%] {\\n  background: none;\\n  border: none;\\n  cursor: pointer;\\n  transition: color 0.3s ease;\\n  padding: 0;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  width: 100%; \\n\\n  max-width: 100px; \\n\\n}\\n\\n\\n\\nbutton.tooltip[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%] {\\n  font-size: 36px; \\n\\n  color: blue; \\n\\n}\\n\\n\\n\\nbutton.tooltip[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%] {\\n  font-size: 24px; \\n\\n  color: blue; \\n\\n}\\n\\n\\n\\n\\n\\nbutton.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%] {\\n  opacity: 1;\\n}\\n\\n\\n\\nbutton.tooltip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  font-size: 14px;\\n  margin-top: 4px;\\n  text-align: center;\\n}\\n\\n\\n\\nbutton.tooltip[_ngcontent-%COMP%]:disabled {\\n  color: #ccc; \\n\\n  cursor: not-allowed;\\n}\\n\\n\\n\\n.custom-alert-message[_ngcontent-%COMP%] {\\n  \\n\\n  font-size: 16px;\\n  color: #333;\\n  \\n\\n}\\n\\nion-item[_ngcontent-%COMP%] {\\n  color: darkblue;\\n  background-color: chartreuse;\\n}\\n\\n\\n\\n.red-bold-label[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n  color: red;\\n}\\n\\n\\n\\n.bold-text[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n}\\n\\n.myColor[_ngcontent-%COMP%] {\\n  background-color: aqua;\\n}\\n\\nion-content[_ngcontent-%COMP%] {\\n  --background:#6018e7;\\n}\\n\\nion-searchbar[_ngcontent-%COMP%] {\\n  position: sticky;\\n  top: 0;\\n  z-index: 1000;\\n}\\n\\n\\n\\n.commerce-image[_ngcontent-%COMP%] {\\n  width: 100%; \\n\\n  height: 200px; \\n\\n  object-fit: contain; \\n\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvdmlsbGVzLWNvbW1lcmNlcy92aWxsZXMtY29tbWVyY2VzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLHlDQUFBO0FBQ0o7O0FBRUU7RUFDRSxnQ0FBQTtBQUNKOztBQUVFLCtCQUFBO0FBQ0E7RUFDRSw2QkFBQSxFQUFBLHdDQUFBO0FBQ0o7O0FBRUUsd0JBQUE7QUFDQTtFQUNFLG1DQUFBLEVBQUEsc0RBQUE7RUFDQSxzQ0FBQSxFQUFBLGlEQUFBO0FBQ0o7O0FBRUUsOEJBQUE7QUFDRjtFQUNFLGlCQUFBLEVBQUEsK0JBQUE7QUFDRjs7QUFFQSxvQ0FBQTtBQUNBO0VBQ0UsYUFBQTtFQUNBLDhCQUFBO0VBQ0EsU0FBQSxFQUFBLDZDQUFBO0VBQ0EsY0FBQSxFQUFBLGdDQUFBO0FBQ0Y7O0FBRUEsc0NBQUE7QUFDQTtFQUNFLGdCQUFBO0VBQ0EsWUFBQTtFQUNBLGVBQUE7RUFDQSwyQkFBQTtFQUNBLFVBQUE7RUFDQSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxtQkFBQTtFQUNBLFdBQUEsRUFBQSxpREFBQTtFQUNBLGdCQUFBLEVBQUEsd0NBQUE7QUFDRjs7QUFFQSxxQ0FBQTtBQUNBO0VBQ0UsZUFBQSxFQUFBLG1DQUFBO0VBQ0EsV0FBQSxFQUFBLGtDQUFBO0FBQ0Y7O0FBRUEscUNBQUE7QUFDQTtFQUNFLGVBQUEsRUFBQSxnREFBQTtFQUNBLFdBQUEsRUFBQSxrQ0FBQTtBQUNGOztBQUVBLCtCQUFBO0FBR0Esc0NBQUE7QUFDQTtFQUNFLFVBQUE7QUFERjs7QUFJQSwwQkFBQTtBQUNBO0VBQ0UsZUFBQTtFQUNBLGVBQUE7RUFDQSxrQkFBQTtBQURGOztBQUlBLDBCQUFBO0FBQ0E7RUFDRSxXQUFBLEVBQUEsNENBQUE7RUFDQSxtQkFBQTtBQURGOztBQUtBLHNEQUFBO0FBQ0E7RUFDRSxnQ0FBQTtFQUNBLGVBQUE7RUFDQSxXQUFBO0VBQ0EsOEJBQUE7QUFGRjs7QUFLQTtFQUNFLGVBQUE7RUFDQSw0QkFBQTtBQUZGOztBQUtBLDhCQUFBO0FBQ0E7RUFDRSxpQkFBQTtFQUNBLFVBQUE7QUFGRjs7QUFLQSw4QkFBQTtBQUNBO0VBQ0UsaUJBQUE7QUFGRjs7QUFLQTtFQUNFLHNCQUFBO0FBRkY7O0FBS0E7RUFDRSxvQkFBQTtBQUZGOztBQUtBO0VBRUUsZ0JBQUE7RUFDQSxNQUFBO0VBQ0EsYUFBQTtBQUZGOztBQUtBLHNEQUFBO0FBQ0E7RUFDRSxXQUFBLEVBQUEsc0JBQUE7RUFDQSxhQUFBLEVBQUEsdUNBQUE7RUFDQSxtQkFBQSxFQUFBLG1EQUFBO0FBRkYiLCJzb3VyY2VzQ29udGVudCI6WyIuZXZlbi1pdGVtIHtcclxuICAgIC0taW9uLWl0ZW0tYmFja2dyb3VuZDogcmdiKDE1NiwgMjE4LCAyNDMpO1xyXG4gIH1cclxuICBcclxuICAub2RkLWl0ZW0ge1xyXG4gICAgLS1pb24taXRlbS1iYWNrZ3JvdW5kOiBsaWdodHBpbms7XHJcbiAgfVxyXG4gIFxyXG4gIC8qIEFkZCBhIGJvcmRlciB0byBsaXN0IGl0ZW1zICovXHJcbiAgaW9uLWl0ZW0ge1xyXG4gICAgLS1pb24taXRlbS1ib3JkZXItY29sb3I6ICNjY2M7IC8qIENoYW5nZSB0byB5b3VyIGRlc2lyZWQgYm9yZGVyIGNvbG9yICovXHJcbiAgfVxyXG4gIFxyXG4gIC8qIFN0eWxlIHRoZSBzY3JvbGxiYXIgKi9cclxuICBpb24tY29udGVudCB7XHJcbiAgICAtLWlvbi1zY3JvbGxiYXItYmFja2dyb3VuZDogI2YwZjBmMDsgLyogQ2hhbmdlIHRvIHlvdXIgZGVzaXJlZCBzY3JvbGxiYXIgYmFja2dyb3VuZCBjb2xvciAqL1xyXG4gICAgLS1pb24tc2Nyb2xsYmFyLXRodW1iLWJhY2tncm91bmQ6ICM5OTk7IC8qIENoYW5nZSB0byB5b3VyIGRlc2lyZWQgc2Nyb2xsYmFyIHRodW1iIGNvbG9yICovXHJcbiAgfVxyXG4gIFxyXG4gIC8qIHN0eWxlcy5jc3Mgb3Igc3R5bGVzLnNjc3MgKi9cclxuLmlvblNlbGVjdFJpZ2h0IHtcclxuICAtLWlvbi1pdGVtLWVuZDogMDsgLyogQWRqdXN0IHRoZSB2YWx1ZSBhcyBuZWVkZWQgKi9cclxufVxyXG5cclxuLyogU3R5bGUgdGhlIGZvcm0gYnV0dG9uIGNvbnRhaW5lciAqL1xyXG4uZm9ybS1idXR0b25zIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICBnYXA6IDEwcHg7IC8qIEFkanVzdCB0aGUgZ2FwIGJldHdlZW4gYnV0dG9ucyBhcyBuZWVkZWQgKi9cclxuICBtYXJnaW46IDEwcHggMDsgLyogQWRkIG1hcmdpbiB0byB0aGUgY29udGFpbmVyICovXHJcbn1cclxuXHJcbi8qIFN0eWxlIGVhY2ggYnV0dG9uIGFuZCBpdHMgdG9vbHRpcCAqL1xyXG5idXR0b24udG9vbHRpcCB7XHJcbiAgYmFja2dyb3VuZDogbm9uZTtcclxuICBib3JkZXI6IG5vbmU7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIHRyYW5zaXRpb246IGNvbG9yIDAuM3MgZWFzZTtcclxuICBwYWRkaW5nOiAwO1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIHdpZHRoOiAxMDAlOyAvKiBNYWtlIGVhY2ggYnV0dG9uIG9jY3VweSAyNSUgb2YgdGhlIGNvbnRhaW5lciAqL1xyXG4gIG1heC13aWR0aDogMTAwcHg7IC8qIFNldCBhIG1heGltdW0gd2lkdGggZm9yIGVhY2ggYnV0dG9uICovXHJcbn1cclxuXHJcbi8qIFN0eWxlIHRoZSBpY29uIHdpdGhpbiB0aGUgYnV0dG9uICovXHJcbmJ1dHRvbi50b29sdGlwIGlvbi1pY29uIHtcclxuICBmb250LXNpemU6IDM2cHg7IC8qIEFkanVzdCB0aGUgaWNvbiBzaXplIGFzIG5lZWRlZCAqL1xyXG4gIGNvbG9yOiBibHVlOyAvKiBDaGFuZ2UgdGhlIGljb24gY29sb3IgdG8gYmx1ZSAqL1xyXG59XHJcblxyXG4vKiBTdHlsZSB0aGUgaWNvbiB3aXRoaW4gdGhlIGJ1dHRvbiAqL1xyXG5idXR0b24udG9vbHRpcCBpb24taWNvbiB7XHJcbiAgZm9udC1zaXplOiAyNHB4OyAvKiBBZGp1c3QgdGhlIGljb24gc2l6ZSBhcyBuZWVkZWQgKGUuZy4sIDI0cHgpICovXHJcbiAgY29sb3I6IGJsdWU7IC8qIENoYW5nZSB0aGUgaWNvbiBjb2xvciB0byBibHVlICovXHJcbn1cclxuXHJcbi8qIFJlc3Qgb2YgeW91ciBDU1Mgc3R5bGVzLi4uICovXHJcblxyXG5cclxuLyogU2hvdyB0b29sdGlwIHRleHQgb24gYnV0dG9uIGhvdmVyICovXHJcbmJ1dHRvbi50b29sdGlwOmhvdmVyIC50b29sdGlwdGV4dCB7XHJcbiAgb3BhY2l0eTogMTtcclxufVxyXG5cclxuLyogU3R5bGUgdGhlIGJ1dHRvbiB0ZXh0ICovXHJcbmJ1dHRvbi50b29sdGlwIHNwYW4ge1xyXG4gIGZvbnQtc2l6ZTogMTRweDtcclxuICBtYXJnaW4tdG9wOiA0cHg7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4vKiBTdHlsZSBkaXNhYmxlZCBidXR0b24gKi9cclxuYnV0dG9uLnRvb2x0aXA6ZGlzYWJsZWQge1xyXG4gIGNvbG9yOiAjY2NjOyAvKiBDaGFuZ2UgdGhlIGNvbG9yIG9mIHRoZSBkaXNhYmxlZCBidXR0b24gKi9cclxuICBjdXJzb3I6IG5vdC1hbGxvd2VkO1xyXG59XHJcblxyXG5cclxuLyogc3R5bGVzLnNjc3Mgb3IgeW91ciBjb21wb25lbnQtc3BlY2lmaWMgLnNjc3MgZmlsZSAqL1xyXG4uY3VzdG9tLWFsZXJ0LW1lc3NhZ2Uge1xyXG4gIC8qIEFkZCB5b3VyIGN1c3RvbSBzdHlsZXMgaGVyZSAqL1xyXG4gIGZvbnQtc2l6ZTogMTZweDtcclxuICBjb2xvcjogIzMzMztcclxuICAvKiBBZGQgbW9yZSBzdHlsZXMgYXMgbmVlZGVkICovXHJcbn1cclxuXHJcbmlvbi1pdGVtIHtcclxuICBjb2xvcjogZGFya2JsdWU7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogY2hhcnRyZXVzZTtcclxufVxyXG5cclxuLyogQWRkIHRoaXMgdG8geW91ciBDU1MgZmlsZSAqL1xyXG4ucmVkLWJvbGQtbGFiZWwge1xyXG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gIGNvbG9yOiByZWQ7XHJcbn1cclxuXHJcbi8qIEFkZCB0aGlzIHRvIHlvdXIgQ1NTIGZpbGUgKi9cclxuLmJvbGQtdGV4dCB7XHJcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbn1cclxuXHJcbi5teUNvbG9yIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiBhcXVhO1xyXG59XHJcblxyXG5pb24tY29udGVudHtcclxuICAtLWJhY2tncm91bmQ6IzYwMThlNztcclxufVxyXG5cclxuaW9uLXNlYXJjaGJhciB7XHJcbiAgcG9zaXRpb246IC13ZWJraXQtc3RpY2t5O1xyXG4gIHBvc2l0aW9uOiBzdGlja3k7XHJcbiAgdG9wOiAwO1xyXG4gIHotaW5kZXg6IDEwMDA7XHJcbn1cclxuICBcclxuLyogRGVmaW5lIENTUyBjbGFzcyBmb3IgY29udHJvbGxpbmcgaW1hZ2UgZGltZW5zaW9ucyAqL1xyXG4uY29tbWVyY2UtaW1hZ2Uge1xyXG4gIHdpZHRoOiAxMDAlOyAvKiBTZXQgd2lkdGggdG8gMTAwJSAqL1xyXG4gIGhlaWdodDogMjAwcHg7IC8qIFNldCBhIGZpeGVkIGhlaWdodCBmb3IgY29uc2lzdGVuY3kgKi9cclxuICBvYmplY3QtZml0OiBjb250YWluOyAvKiBNYWludGFpbiBhc3BlY3QgcmF0aW8gYW5kIGZpdCB3aXRoaW4gY29udGFpbmVyICovXHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"names":["VillesModalPage","i0","ɵɵelementStart","ɵɵlistener","VillesCommercesPage_ion_list_11_ion_card_1_Template_ion_card_click_0_listener","restoredCtx","ɵɵrestoreView","_r4","commerce_r2","$implicit","ctx_r3","ɵɵnextContext","ɵɵresetView","navigateToCommerceCategories","id","ɵɵelement","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵproperty","image_commerce","ɵɵtextInterpolate","commercename","services","villeName","ɵɵtemplate","VillesCommercesPage_ion_list_11_ion_card_1_Template","ctx_r0","commerces","VillesCommercesPage","constructor","router","userService","commerceService","navCtrl","modalCtrl","cdr","clickedElementService","villes","selectedVilleId","showSelectWithVille","ngOnInit","commerces$","subscribe","console","log","fetchAndEnhanceCommerces","_this","_asyncToGenerator","getAllCommercesBelongingOwnersWithMonthlyFeePaid","sort","a","b","commerce","getVilleNameByVilleId","ville_id","businessOwner","getBusinessOwnerById","business_owner_id","error","goToLoginPage","destroy","navigate","element","document","getElementById","remove","search","event","_this2","query","detail","value","trim","searchingCommerces","filterByVilleId","villeId","_this3","getCommercesByVilleId1","clearFilter","_this4","openVillesModalPage","_this5","villesList","getVillesFromCommerces","modal","create","component","componentProps","onDidDismiss","then","result","data","present","navigateToCommerceCategories1","commerceId","clickedCommerce","find","state","setClickedCommerce","_","ɵɵdirectiveInject","i1","Router","i2","UserService","i3","CommerceService","i4","NavController","ModalController","ChangeDetectorRef","i5","ClickedElementService","_2","selectors","decls","vars","consts","template","VillesCommercesPage_Template","rf","ctx","VillesCommercesPage_Template_ion_button_click_5_listener","VillesCommercesPage_Template_ion_searchbar_ionInput_9_listener","$event","VillesCommercesPage_ion_list_11_Template","VillesCommercesPage_Template_ion_button_click_16_listener","VillesCommercesPage_Template_ion_button_click_19_listener","length"],"sources":["C:\\Users\\jclon\\chatgptVcp\\Ionic-vcp-macbook27mars22024\\src\\app\\pages\\villes-commerces\\villes-commerces.page.ts","C:\\Users\\jclon\\chatgptVcp\\Ionic-vcp-macbook27mars22024\\src\\app\\pages\\villes-commerces\\villes-commerces.page.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { UserService } from 'src/app/services/user.service';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { CommerceService } from 'src/app/services/commerce.service';\r\nimport { NavController } from '@ionic/angular';\r\nimport { ViewChild } from '@angular/core';\r\nimport { IonSelect } from '@ionic/angular';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { VillesModalPage } from '../villes-modal/villes-modal.page';\r\nimport { ChangeDetectorRef } from '@angular/core';\r\nimport { ClickedElementService } from 'src/app/services/clicked-element.service';\r\n\r\n@Component({\r\n  selector: 'app-villes-commerces',\r\n  templateUrl: './villes-commerces.page.html',\r\n  styleUrls: ['./villes-commerces.page.scss'],\r\n})\r\nexport class VillesCommercesPage implements OnInit {\r\n  villes: any[] = [];\r\n  commerces: any[] = [];\r\n  selectedVilleId: number | null = null;\r\n  showSelectWithVille: boolean = true;\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private userService: UserService,\r\n    private commerceService: CommerceService,\r\n    private navCtrl: NavController,\r\n    private modalCtrl: ModalController,\r\n    private cdr: ChangeDetectorRef,\r\n    private clickedElementService: ClickedElementService, // Inject ClickedElementService\r\n\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    // Subscribe to changes in commerces array\r\n    this.commerceService.commerces$.subscribe(commerces => {\r\n      // Update local commerces array with the new data\r\n      this.commerces = commerces;\r\n    });\r\n    console.log('at the Init : ', this.commerces)\r\n    this.fetchAndEnhanceCommerces();\r\n  }\r\n\r\n  // Inside the ngOnInit method of your component\r\n  async fetchAndEnhanceCommerces() {\r\n    try {\r\n      // Fetch commerces\r\n      const commerces = \r\n        await this.commerceService.getAllCommercesBelongingOwnersWithMonthlyFeePaid();\r\n\r\n      // Sort the commerces array by ID in ascending order\r\n      commerces.sort((a, b) => a.id - b.id);\r\n\r\n      // Enhance commerces array with villeName and business owner information\r\n      for (const commerce of commerces) {\r\n        // Get the ville name for the commerce\r\n        commerce.villeName = await this.commerceService.getVilleNameByVilleId(\r\n          commerce.ville_id\r\n        );\r\n\r\n        // Get the business owner information for the commerce\r\n        commerce.businessOwner = await this.userService.getBusinessOwnerById(\r\n          commerce.business_owner_id\r\n        );\r\n      }\r\n\r\n      // Now the commerces array is enhanced with villeName and business owner information\r\n      this.commerces = commerces;\r\n    } catch (error) {\r\n      console.error('Error fetching and enhancing commerces:', error);\r\n    }\r\n  }\r\n\r\n   goToLoginPage() {\r\n    // Completely shut down the current page\r\n    this.destroy();\r\n    \r\n    // Navigate to the login page\r\n    this.router.navigate(['/login']);\r\n  }\r\n\r\n  private destroy() {\r\n    const element = document.getElementById('villes-commerces-page');\r\n    if (element) {\r\n      element.remove();\r\n    }\r\n  }\r\n\r\n  async search(event: CustomEvent) {\r\n    const query: string = event?.detail?.value || '';\r\n  \r\n    try {\r\n      // If a search query is provided, filter commerces\r\n      if (query.trim() !== '') {\r\n        this.commerces = await this.commerceService.searchingCommerces(query);\r\n        // Enhance the filtered commerces array with villeName and other information\r\n        \r\n        for (const commerce of this.commerces) {\r\n          // Get the ville name for the commerce\r\n          commerce.villeName = await this.commerceService.getVilleNameByVilleId(\r\n            commerce.ville_id\r\n          );\r\n  \r\n          // Get any additional information you need for the commerce\r\n          commerce.businessOwner = await this.userService.getBusinessOwnerById(\r\n            commerce.business_owner_id\r\n          );\r\n  \r\n          // Add more enhancements if needed\r\n        }\r\n  \r\n      } else {\r\n        // If no search query, fetch and enhance all commerces\r\n        await this.fetchAndEnhanceCommerces();\r\n      }\r\n  \r\n    } catch (error) {\r\n      console.error('Error searching commerces:', error);\r\n    }\r\n  }\r\n  \r\n\r\n  async filterByVilleId(villeId: number) {\r\n    try {\r\n      // Filter commerces by villeId\r\n      const commerces = await this.commerceService.getCommercesByVilleId1(\r\n        villeId\r\n      );\r\n\r\n      // Enhance the filtered commerces array with villeName and other information\r\n      for (const commerce of commerces) {\r\n        // Get the ville name for the commerce\r\n        commerce.villeName = await this.commerceService.getVilleNameByVilleId(\r\n          commerce.ville_id\r\n        );\r\n\r\n        // Get any additional information you need for the commerce\r\n        commerce.businessOwner = await this.userService.getBusinessOwnerById(\r\n          commerce.business_owner_id\r\n        );\r\n\r\n        // Add more enhancements if needed\r\n      }\r\n\r\n      // Sort the commerces array by ID in ascending order\r\n      commerces.sort((a, b) => a.id - b.id);\r\n\r\n      // Update the commerces array with filtered and enhanced information\r\n      this.commerces = commerces;\r\n    } catch (error) {\r\n      console.error('Error filtering commerces by villeId:', error);\r\n    }\r\n  }\r\n\r\n\r\n  async clearFilter() {\r\n    try {\r\n      // Clear the filter and fetch and enhance all commerces\r\n      await this.fetchAndEnhanceCommerces();\r\n\r\n      // Reset the selected value in the ion-select\r\n      this.selectedVilleId = null;\r\n\r\n      // Toggle the rendering of ion-select\r\n      this.showSelectWithVille = true;\r\n    } catch (error) {\r\n      console.error('Error clearing filter:', error);\r\n    }\r\n  }\r\n\r\n  async openVillesModalPage() {\r\n    console.log ('this.commerces', this.commerces);\r\n    const villesList = this.commerceService.getVillesFromCommerces(this.commerces);\r\n    console.log ('villes Liste', villesList);\r\n    /* const villesList = await this.commerceService.getAllVilles();\r\n    console.log ('villesList', villesList); */\r\n\r\n    const modal = await this.modalCtrl.create({\r\n      component: VillesModalPage,\r\n      componentProps: {\r\n        villesList: villesList, // Pass the list of villes to the modal\r\n      },\r\n    });\r\n\r\n    modal.onDidDismiss().then((result) => {\r\n      // Handle the result from the modal if needed\r\n      if (result.data) {\r\n        // Handle the selected ville\r\n        this.filterByVilleId(result.data);\r\n      }\r\n    });\r\n\r\n    return await modal.present();\r\n  }\r\n\r\n  navigateToCommerceCategories1(commerceId: number) {\r\n    const clickedCommerce = this.commerces.find(\r\n      (commerce) => commerce.id === commerceId\r\n    );\r\n    this.router.navigate(['/category-products', commerceId], {\r\n      state: { clickedCommerce },\r\n    });\r\n  }\r\n\r\n  navigateToCommerceCategories(commerceId: number) {\r\n    const clickedCommerce = this.commerces.find(\r\n      (commerce) => commerce.id === commerceId\r\n    );\r\n    // Set the clickedCommerce in the ClickedElementService\r\n    this.clickedElementService.setClickedCommerce(clickedCommerce);\r\n    // Navigate to the category products page\r\n    this.router.navigate(['/category-products', commerceId]);\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar color=\"primary\">\r\n    <ion-title>\r\n      Villes Commerces\r\n    </ion-title>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"goToLoginPage()\">\r\n        Login\r\n      </ion-button>\r\n    </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-header>\r\n  <!-- Fixed Search Bar -->\r\n  <div class=\"custom-toolbar\" color=\"primary\">\r\n    <ion-searchbar (ionInput)=\"search($event)\"></ion-searchbar>\r\n    <!-- You can add any additional buttons or elements here -->\r\n  </div>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-list *ngIf=\"commerces.length > 0\">\r\n    <ion-card *ngFor=\"let commerce of commerces\" (click)=\"navigateToCommerceCategories(commerce.id)\">\r\n      <ion-img class=\"commerce-image\" [src]=\"commerce.image_commerce\" alt=\"Commerce Logo\"></ion-img>\r\n      <ion-card-header>\r\n        <ion-card-title>{{ commerce.commercename }}</ion-card-title>\r\n        <ion-card-subtitle>{{ commerce.services }}</ion-card-subtitle>\r\n      </ion-card-header>\r\n      <ion-card-content>\r\n        <p>{{ commerce.villeName || 'Unknown Ville' }}</p>\r\n      </ion-card-content>\r\n    </ion-card>\r\n  </ion-list> \r\n</ion-content>\r\n\r\n<ion-footer>\r\n  <ion-toolbar>\r\n    <ion-row>\r\n      <ion-col size=\"6\">\r\n        <!-- Button to open the modal for selecting a ville -->\r\n        <ion-button (click)=\"openVillesModalPage()\" expand=\"full\">Select Ville</ion-button>\r\n      </ion-col>\r\n      <ion-col size=\"6\">\r\n        <!-- Button to clear the filter -->\r\n        <ion-button (click)=\"clearFilter()\" expand=\"full\">Clear Filter</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-toolbar>\r\n</ion-footer>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}