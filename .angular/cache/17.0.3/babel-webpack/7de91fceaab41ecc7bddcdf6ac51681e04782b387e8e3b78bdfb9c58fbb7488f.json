{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jclon/chatgptVcp/Ionic-vcp-macbook27mars22024/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\nimport { CommerceCategoriesPage } from '../commerce-categories/commerce-categories.page';\nimport { UpdateCategoryModalPage } from '../update-category-modal/update-category-modal.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/user.service\";\nimport * as i2 from \"src/app/services/commerce.service\";\nimport * as i3 from \"src/app/services/category.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@ionic/angular\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@angular/common\";\nfunction CategoriesPage_ion_list_17_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 14);\n    i0.ɵɵlistener(\"click\", function CategoriesPage_ion_list_17_ion_item_1_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const commerce_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.onCommerceClick(commerce_r6.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const commerce_r6 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"selected-commerce\", commerce_r6.id === ctx_r5.selectedCommerceId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", commerce_r6.commercename, \" \");\n  }\n}\nfunction CategoriesPage_ion_list_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 12);\n    i0.ɵɵtemplate(1, CategoriesPage_ion_list_17_ion_item_1_Template, 2, 3, \"ion-item\", 13);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.commerces);\n  }\n}\nfunction CategoriesPage_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"p\");\n    i0.ɵɵtext(2, \"No commerces found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CategoriesPage_ion_list_21_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 14);\n    i0.ɵɵlistener(\"click\", function CategoriesPage_ion_list_21_ion_item_1_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const category_r10 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.onCategoryClick(category_r10));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const category_r10 = ctx.$implicit;\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"selected-category\", category_r10.id === ctx_r9.selectedCategoryId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", category_r10.categoryname, \" \");\n  }\n}\nfunction CategoriesPage_ion_list_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 12);\n    i0.ɵɵtemplate(1, CategoriesPage_ion_list_21_ion_item_1_Template, 2, 3, \"ion-item\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.categories);\n  }\n}\nfunction CategoriesPage_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"p\");\n    i0.ɵɵtext(2, \"No categories found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CategoriesPage_ion_card_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"ion-card-header\")(2, \"ion-card-title\");\n    i0.ɵɵtext(3, \"Category Details\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ion-card-content\")(5, \"form\", 18)(6, \"ion-item\");\n    i0.ɵɵelement(7, \"ion-img\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ion-item\")(9, \"ion-label\");\n    i0.ɵɵtext(10, \"ID : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"ion-input\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"ion-item\")(13, \"ion-label\");\n    i0.ɵɵtext(14, \"Category Name : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"ion-input\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"ion-item\")(17, \"ion-label\");\n    i0.ɵɵtext(18, \"Commerce ID : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(19, \"ion-input\", 22);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    let tmp_1_0;\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formGroup\", ctx_r4.categoryForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", (tmp_1_0 = ctx_r4.categoryForm.get(\"image_category\")) == null ? null : tmp_1_0.value);\n  }\n}\nexport class CategoriesPage {\n  constructor(userService, commerceService, categoryService, formBuilder, modalController, router) {\n    this.userService = userService;\n    this.commerceService = commerceService;\n    this.categoryService = categoryService;\n    this.formBuilder = formBuilder;\n    this.modalController = modalController;\n    this.router = router;\n    this.categories = [];\n    this.commerces = [];\n    this.selectedCommerceId = null;\n    this.categoryForm = null;\n    this.selectedCategoryId = null;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Fetch business owner ID\n        const businessOwnerId = yield _this.userService.getBusinessOwnerId();\n        // Fetch commerces\n        if (businessOwnerId !== null) {\n          const monthlyFeePaid = yield _this.userService.getMonthlyFeePaidStatus(businessOwnerId);\n          if (!monthlyFeePaid) {\n            _this.lockApp();\n            return;\n          }\n          const commerces = yield _this.commerceService.getCommercesByBusinessOwnerWithMonthlyFeePaid(businessOwnerId);\n          commerces.sort((a, b) => a.id - b.id);\n          _this.commerces = commerces;\n          // Check if there are commerces in the list\n          if (_this.commerces.length > 0) {\n            // Select the first commerce by default\n            _this.selectedCommerceId = _this.commerces[0].id;\n            // Fetch categories associated with the selected commerce\n            if (_this.selectedCommerceId !== null) {\n              yield _this.fetchCategoriesByCommerceId(_this.selectedCommerceId);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching commerces:', error);\n      }\n    })();\n  }\n  onCommerceClick(commerceId) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.selectedCommerceId = commerceId;\n      yield _this2.fetchCategoriesByCommerceId(commerceId);\n    })();\n  }\n  fetchCategoriesByCommerceId(commerceId) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Fetch categories associated with the selected commerce\n        const categories = yield _this3.categoryService.getCategoriesByCommerceId(commerceId);\n        categories.sort((a, b) => a.id - b.id);\n        _this3.categories = categories;\n        if (_this3.categories.length > 0) {\n          // Select the first category by default\n          _this3.selectedCategoryId = _this3.categories[0].id;\n          // Display details of the first category\n          _this3.setCategoryForm(_this3.categories[0]);\n        } else {\n          // Reset the category form if no categories found\n          _this3.clearCategoryForm();\n        }\n      } catch (error) {\n        console.error('Error fetching categories:', error);\n      }\n    })();\n  }\n  clearCategoryForm() {\n    this.categoryForm?.reset();\n  }\n  onCategoryClick(category) {\n    // Set the selected category ID\n    this.selectedCategoryId = category.id;\n    // Set the form for the clicked category\n    this.setCategoryForm(category);\n  }\n  setCategoryForm(category) {\n    const formGroup = {};\n    // Iterate through each category field and create form control\n    Object.keys(category).forEach(key => {\n      formGroup[key] = new FormControl(category[key], Validators.required);\n    });\n    this.categoryForm = new FormGroup(formGroup);\n  }\n  // Method to open CommerceCategories modal\n  openCommerceCategoriesPage() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      if (_this4.selectedCommerceId !== null) {\n        // Fetch the complete commerce object using the ID\n        const commerce = yield _this4.commerceService.getCommerceById(_this4.selectedCommerceId);\n        if (commerce) {\n          const modal = yield _this4.modalController.create({\n            component: CommerceCategoriesPage,\n            componentProps: {\n              business_owner_id: commerce.business_owner_id,\n              ville_id: commerce.ville_id,\n              commerce_id: commerce.id\n            }\n          });\n          modal.onDidDismiss().then(result => {\n            console.log('Modal dismissed:', result);\n            if (result.data.dismissed === 'confirm') {\n              // Handle confirmation\n              console.log('Modal dismissed with confirm role');\n              // For example, refresh category data\n              _this4.refreshCategoryData();\n            } else if (result.data.dismissed === 'cancel') {\n              // Handle cancellation\n              console.log('Modal dismissed with cancel role');\n            } else {\n              // Handle other dismissals\n              console.log('Modal dismissed with unexpected role:', result.data.dismissed);\n            }\n          });\n          return yield modal.present();\n        }\n      }\n    })();\n  }\n  refreshCategoryData() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      if (_this5.selectedCommerceId !== null) {\n        try {\n          _this5.categories = yield _this5.categoryService.getCategoriesByCommerceId(_this5.selectedCommerceId);\n          _this5.categories.sort((a, b) => a.id - b.id);\n          if (_this5.categories.length > 0) {\n            const new_category = _this5.categories[_this5.categories.length - 1];\n            _this5.selectedCategoryId = new_category.id;\n            _this5.setCategoryForm(new_category);\n          }\n        } catch (error) {\n          console.error('Error refreshing categories:', error);\n        }\n      }\n    })();\n  }\n  refreshCategoryDataUp() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      if (_this6.selectedCommerceId !== null) {\n        try {\n          const categories = yield _this6.categoryService.getCategoriesByCommerceId(_this6.selectedCommerceId);\n          categories.sort((a, b) => a.id - b.id);\n          _this6.categories = categories;\n          if (_this6.selectedCategoryId) {\n            const latestCategory = yield _this6.categoryService.getCategoryByCategoryId(_this6.selectedCategoryId);\n            _this6.setCategoryForm(latestCategory);\n          }\n        } catch (error) {\n          console.error('Error refreshing categories:', error);\n        }\n      }\n    })();\n  }\n  openUpdateCategoryModal() {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      let defaultCategory;\n      // Check if there is a selected category\n      if (_this7.selectedCategoryId !== null) {\n        // Use the selected category as the default if available\n        defaultCategory = _this7.categories.find(category => category.id === _this7.selectedCategoryId);\n      } else if (_this7.categories.length > 0) {\n        // If no selected category, use the first category from the list of categories\n        defaultCategory = _this7.categories[0];\n      }\n      // Open the modal with the default category as a prop\n      const modal = yield _this7.modalController.create({\n        component: UpdateCategoryModalPage,\n        componentProps: {\n          category: defaultCategory\n        }\n      });\n      modal.onDidDismiss().then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (result) {\n          console.log('Modal dismissed:', result);\n          if (result.data.dismissed === 'confirm') {\n            // Handle confirmation\n            console.log('Modal dismissed with confirm role');\n            // Refresh the updated category\n            yield _this7.refreshCategoryDataUp();\n          } else if (result.data.dismissed === 'cancel') {\n            // Handle cancellation\n            console.log('Modal dismissed with cancel role');\n          } else {\n            // Handle other dismissals\n            console.log('Modal dismissed with unexpected role:', result.data.dismissed);\n          }\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n      yield modal.present();\n    })();\n  }\n  lockApp() {\n    // Disable form controls or redirect to a locked page\n    // this.commerceForm.disable();\n    // Example: Show a locked message or redirect to a locked page\n    this.router.navigate(['/villes-commerces']);\n  }\n  static #_ = this.ɵfac = function CategoriesPage_Factory(t) {\n    return new (t || CategoriesPage)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.CommerceService), i0.ɵɵdirectiveInject(i3.CategoryService), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(i5.ModalController), i0.ɵɵdirectiveInject(i6.Router));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CategoriesPage,\n    selectors: [[\"app-categories\"]],\n    decls: 27,\n    vars: 5,\n    consts: [[\"slot\", \"end\"], [\"color\", \"primary\", 3, \"click\"], [1, \"grid-container\"], [\"size\", \"6\", 1, \"column\"], [\"scrolly\", \"true\", 2, \"max-height\", \"100px\"], [\"class\", \"list\", 4, \"ngIf\"], [\"class\", \"no-commerces-message\", 4, \"ngIf\"], [\"class\", \"no-categories-message\", 4, \"ngIf\"], [4, \"ngIf\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\"], [3, \"click\"], [\"name\", \"add\"], [1, \"list\"], [\"class\", \"item\", 3, \"selected-commerce\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"item\", 3, \"click\"], [1, \"no-commerces-message\"], [\"class\", \"item\", 3, \"selected-category\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"no-categories-message\"], [3, \"formGroup\"], [3, \"src\"], [\"formControlName\", \"id\", \"readonly\", \"\"], [\"formControlName\", \"categoryname\", \"readonly\", \"\"], [\"formControlName\", \"commerce_id\", \"readonly\", \"\"]],\n    template: function CategoriesPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n        i0.ɵɵtext(3, \"Categories\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-buttons\", 0)(5, \"ion-button\", 1);\n        i0.ɵɵlistener(\"click\", function CategoriesPage_Template_ion_button_click_5_listener() {\n          return ctx.openUpdateCategoryModal();\n        });\n        i0.ɵɵtext(6, \" Edit \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(7, \"ion-content\")(8, \"ion-grid\", 2)(9, \"ion-row\")(10, \"ion-col\", 3);\n        i0.ɵɵtext(11, \" commerces \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"ion-col\", 3);\n        i0.ɵɵtext(13, \" categories \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"ion-row\")(15, \"ion-col\", 3)(16, \"div\", 4);\n        i0.ɵɵtemplate(17, CategoriesPage_ion_list_17_Template, 2, 1, \"ion-list\", 5)(18, CategoriesPage_div_18_Template, 3, 0, \"div\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"ion-col\", 3)(20, \"div\", 4);\n        i0.ɵɵtemplate(21, CategoriesPage_ion_list_21_Template, 2, 1, \"ion-list\", 5)(22, CategoriesPage_div_22_Template, 3, 0, \"div\", 7);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(23, CategoriesPage_ion_card_23_Template, 20, 2, \"ion-card\", 8);\n        i0.ɵɵelementStart(24, \"ion-fab\", 9)(25, \"ion-fab-button\", 10);\n        i0.ɵɵlistener(\"click\", function CategoriesPage_Template_ion_fab_button_click_25_listener() {\n          return ctx.openCommerceCategoriesPage();\n        });\n        i0.ɵɵelement(26, \"ion-icon\", 11);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"ngIf\", ctx.commerces.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.commerces.length === 0);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.categories.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.categories.length === 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.categoryForm);\n      }\n    },\n    dependencies: [i7.NgForOf, i7.NgIf, i4.ɵNgNoValidate, i4.NgControlStatus, i4.NgControlStatusGroup, i5.IonButton, i5.IonButtons, i5.IonCard, i5.IonCardContent, i5.IonCardHeader, i5.IonCardTitle, i5.IonCol, i5.IonContent, i5.IonFab, i5.IonFabButton, i5.IonGrid, i5.IonHeader, i5.IonIcon, i5.IonImg, i5.IonInput, i5.IonItem, i5.IonLabel, i5.IonList, i5.IonRow, i5.IonTitle, i5.IonToolbar, i5.TextValueAccessor, i4.FormGroupDirective, i4.FormControlName],\n    styles: [\"div[scrolly=true][_ngcontent-%COMP%] {\\n  overflow-y: auto;\\n  max-height: 200px; \\n\\n}\\n\\n.grid-container[_ngcontent-%COMP%] {\\n  border: 1px solid #ccc; \\n\\n}\\n\\n.selected-commerce[_ngcontent-%COMP%] {\\n  --ion-item-background: #f0f8ff; \\n\\n}\\n\\nion-item.selected-category[_ngcontent-%COMP%] {\\n  --ion-item-background: #f3e6d5; \\n\\n}\\n\\n.selected-product[_ngcontent-%COMP%] {\\n  --ion-item-background: #eee4eb; \\n\\n}\\n\\n.selected-detail[_ngcontent-%COMP%] {\\n  --ion-item-background: #e0edf8; \\n\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvY2F0ZWdvcmllcy9jYXRlZ29yaWVzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFBO0VBQ0EsaUJBQUEsRUFBQSxrREFBQTtBQUNGOztBQUdBO0VBQ0ksc0JBQUEsRUFBQSwyQkFBQTtBQUFKOztBQVFBO0VBQ0UsOEJBQUEsRUFBQSwwQkFBQTtBQUxGOztBQVFBO0VBQ0UsOEJBQUEsRUFBQSwyQkFBQTtBQUxGOztBQVFBO0VBQ0UsOEJBQUEsRUFBQSwwQkFBQTtBQUxGOztBQVFBO0VBQ0UsOEJBQUEsRUFBQSwwQkFBQTtBQUxGIiwic291cmNlc0NvbnRlbnQiOlsiZGl2W3Njcm9sbHk9XCJ0cnVlXCJdIHtcclxuICBvdmVyZmxvdy15OiBhdXRvO1xyXG4gIG1heC1oZWlnaHQ6IDIwMHB4OyAvKiBUaGlzIHNob3VsZCBtYXRjaCB0aGUgbWF4LWhlaWdodCBpbiB5b3VyIEhUTUwgKi9cclxufVxyXG5cclxuICBcclxuLmdyaWQtY29udGFpbmVyIHtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IC8qIEJvcmRlciBhcm91bmQgdGhlIGdyaWQgKi9cclxufVxyXG4gIFxyXG4gIFxyXG5cclxuXHJcblxyXG5cclxuLnNlbGVjdGVkLWNvbW1lcmNlIHtcclxuICAtLWlvbi1pdGVtLWJhY2tncm91bmQ6ICNmMGY4ZmY7IC8qIExpZ2h0IGJsdWUtZ3JleSBjb2xvciAqL1xyXG59XHJcblxyXG5pb24taXRlbS5zZWxlY3RlZC1jYXRlZ29yeSB7XHJcbiAgLS1pb24taXRlbS1iYWNrZ3JvdW5kOiAjZjNlNmQ1OyAvKiBMaWdodCBicm93bi1ncmV5IGNvbG9yICovXHJcbn1cclxuXHJcbi5zZWxlY3RlZC1wcm9kdWN0IHtcclxuICAtLWlvbi1pdGVtLWJhY2tncm91bmQ6ICNlZWU0ZWI7IC8qIExpZ2h0IGJsdWUtZ3JleSBjb2xvciAqL1xyXG59XHJcblxyXG4uc2VsZWN0ZWQtZGV0YWlsIHtcclxuICAtLWlvbi1pdGVtLWJhY2tncm91bmQ6ICNlMGVkZjg7IC8qIExpZ2h0IGJsdWUtZ3JleSBjb2xvciAqL1xyXG59ICBcclxuXHJcblxyXG5cclxuICAiXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"names":["FormGroup","Validators","FormControl","CommerceCategoriesPage","UpdateCategoryModalPage","i0","ɵɵelementStart","ɵɵlistener","CategoriesPage_ion_list_17_ion_item_1_Template_ion_item_click_0_listener","restoredCtx","ɵɵrestoreView","_r8","commerce_r6","$implicit","ctx_r7","ɵɵnextContext","ɵɵresetView","onCommerceClick","id","ɵɵtext","ɵɵelementEnd","ɵɵclassProp","ctx_r5","selectedCommerceId","ɵɵadvance","ɵɵtextInterpolate1","commercename","ɵɵtemplate","CategoriesPage_ion_list_17_ion_item_1_Template","ɵɵproperty","ctx_r0","commerces","CategoriesPage_ion_list_21_ion_item_1_Template_ion_item_click_0_listener","_r12","category_r10","ctx_r11","onCategoryClick","ctx_r9","selectedCategoryId","categoryname","CategoriesPage_ion_list_21_ion_item_1_Template","ctx_r2","categories","ɵɵelement","ctx_r4","categoryForm","tmp_1_0","get","value","CategoriesPage","constructor","userService","commerceService","categoryService","formBuilder","modalController","router","ngOnInit","_this","_asyncToGenerator","businessOwnerId","getBusinessOwnerId","monthlyFeePaid","getMonthlyFeePaidStatus","lockApp","getCommercesByBusinessOwnerWithMonthlyFeePaid","sort","a","b","length","fetchCategoriesByCommerceId","error","console","commerceId","_this2","_this3","getCategoriesByCommerceId","setCategoryForm","clearCategoryForm","reset","category","formGroup","Object","keys","forEach","key","required","openCommerceCategoriesPage","_this4","commerce","getCommerceById","modal","create","component","componentProps","business_owner_id","ville_id","commerce_id","onDidDismiss","then","result","log","data","dismissed","refreshCategoryData","present","_this5","new_category","refreshCategoryDataUp","_this6","latestCategory","getCategoryByCategoryId","openUpdateCategoryModal","_this7","defaultCategory","find","_ref","_x","apply","arguments","navigate","_","ɵɵdirectiveInject","i1","UserService","i2","CommerceService","i3","CategoryService","i4","FormBuilder","i5","ModalController","i6","Router","_2","selectors","decls","vars","consts","template","CategoriesPage_Template","rf","ctx","CategoriesPage_Template_ion_button_click_5_listener","CategoriesPage_ion_list_17_Template","CategoriesPage_div_18_Template","CategoriesPage_ion_list_21_Template","CategoriesPage_div_22_Template","CategoriesPage_ion_card_23_Template","CategoriesPage_Template_ion_fab_button_click_25_listener"],"sources":["C:\\Users\\jclon\\chatgptVcp\\Ionic-vcp-macbook27mars22024\\src\\app\\pages\\categories\\categories.page.ts","C:\\Users\\jclon\\chatgptVcp\\Ionic-vcp-macbook27mars22024\\src\\app\\pages\\categories\\categories.page.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { UserService } from 'src/app/services/user.service';\r\nimport { CommerceService } from 'src/app/services/commerce.service';\r\nimport { CategoryService } from 'src/app/services/category.service'; // Import CategoryService\r\nimport {\r\n  FormBuilder,\r\n  FormGroup,\r\n  Validators,\r\n  FormControl,\r\n} from '@angular/forms';\r\nimport { CommerceCategoriesPage } from '../commerce-categories/commerce-categories.page';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { UpdateCategoryModalPage } from '../update-category-modal/update-category-modal.page';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-categories',\r\n  templateUrl: './categories.page.html',\r\n  styleUrls: ['./categories.page.scss'],\r\n})\r\nexport class CategoriesPage implements OnInit {\r\n  categories: any[] = [];\r\n  commerces: any[] = [];\r\n  selectedCommerceId: number | null = null;\r\n  categoryForm: FormGroup | null = null;\r\n  selectedCategoryId: number | null = null;\r\n\r\n  constructor(\r\n    private userService: UserService,\r\n    private commerceService: CommerceService,\r\n    private categoryService: CategoryService,\r\n    private formBuilder: FormBuilder,\r\n    private modalController: ModalController,\r\n    private router: Router\r\n  ) {}\r\n\r\n  async ngOnInit() {\r\n    try {\r\n      // Fetch business owner ID\r\n      const businessOwnerId = await this.userService.getBusinessOwnerId();\r\n\r\n      // Fetch commerces\r\n      if (businessOwnerId !== null) {\r\n        const monthlyFeePaid = await this.userService.getMonthlyFeePaidStatus(\r\n          businessOwnerId\r\n        );\r\n        if (!monthlyFeePaid) {\r\n          this.lockApp();\r\n          return;\r\n        }\r\n        const commerces =\r\n          await this.commerceService.getCommercesByBusinessOwnerWithMonthlyFeePaid(\r\n            businessOwnerId\r\n          );\r\n\r\n        commerces.sort((a, b) => a.id - b.id);\r\n        this.commerces = commerces;\r\n\r\n        // Check if there are commerces in the list\r\n        if (this.commerces.length > 0) {\r\n          // Select the first commerce by default\r\n          this.selectedCommerceId = this.commerces[0].id;\r\n          // Fetch categories associated with the selected commerce\r\n          if (this.selectedCommerceId !== null) {\r\n            await this.fetchCategoriesByCommerceId(this.selectedCommerceId);\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching commerces:', error);\r\n    }\r\n  }\r\n\r\n  async onCommerceClick(commerceId: number) {\r\n    this.selectedCommerceId = commerceId;\r\n    await this.fetchCategoriesByCommerceId(commerceId);\r\n  }\r\n\r\n  async fetchCategoriesByCommerceId(commerceId: number) {\r\n    try {\r\n      // Fetch categories associated with the selected commerce\r\n      const categories = await this.categoryService.getCategoriesByCommerceId(\r\n        commerceId\r\n      );\r\n      \r\n      categories.sort((a, b) => a.id - b.id);\r\n      this.categories = categories;\r\n\r\n      if (this.categories.length > 0) {\r\n        // Select the first category by default\r\n        this.selectedCategoryId = this.categories[0].id;\r\n        // Display details of the first category\r\n        this.setCategoryForm(this.categories[0]);\r\n      } else {\r\n        // Reset the category form if no categories found\r\n        this.clearCategoryForm();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching categories:', error);\r\n    }\r\n  }\r\n\r\n  clearCategoryForm() {\r\n    this.categoryForm?.reset();\r\n  }\r\n\r\n  onCategoryClick(category: any) {\r\n    // Set the selected category ID\r\n    this.selectedCategoryId = category.id;\r\n    // Set the form for the clicked category\r\n    this.setCategoryForm(category);\r\n  }\r\n\r\n  setCategoryForm(category: any) {\r\n    const formGroup: any = {};\r\n\r\n    // Iterate through each category field and create form control\r\n    Object.keys(category).forEach((key) => {\r\n      formGroup[key] = new FormControl(category[key], Validators.required);\r\n    });\r\n\r\n    this.categoryForm = new FormGroup(formGroup);\r\n  }\r\n\r\n  // Method to open CommerceCategories modal\r\n  async openCommerceCategoriesPage() {\r\n    if (this.selectedCommerceId !== null) {\r\n      // Fetch the complete commerce object using the ID\r\n      const commerce = await this.commerceService.getCommerceById(\r\n        this.selectedCommerceId\r\n      );\r\n      if (commerce) {\r\n        const modal = await this.modalController.create({\r\n          component: CommerceCategoriesPage,\r\n          componentProps: {\r\n            business_owner_id: commerce.business_owner_id,\r\n            ville_id: commerce.ville_id,\r\n            commerce_id: commerce.id,\r\n          },\r\n        });\r\n\r\n        modal.onDidDismiss().then((result) => {\r\n          console.log('Modal dismissed:', result);\r\n          if (result.data.dismissed === 'confirm') {\r\n            // Handle confirmation\r\n            console.log('Modal dismissed with confirm role');\r\n            // For example, refresh category data\r\n            this.refreshCategoryData();\r\n          } else if (result.data.dismissed === 'cancel') {\r\n            // Handle cancellation\r\n            console.log('Modal dismissed with cancel role');\r\n          } else {\r\n            // Handle other dismissals\r\n            console.log(\r\n              'Modal dismissed with unexpected role:',\r\n              result.data.dismissed\r\n            );\r\n          }\r\n        });\r\n\r\n        return await modal.present();\r\n      }\r\n    }\r\n  }\r\n\r\n  async refreshCategoryData() {\r\n    if (this.selectedCommerceId !== null) {\r\n      try {\r\n        this.categories = await this.categoryService.getCategoriesByCommerceId(\r\n          this.selectedCommerceId\r\n        );\r\n\r\n        this.categories.sort((a, b) => a.id - b.id);\r\n\r\n        if (this.categories.length > 0) {\r\n          const new_category = this.categories[this.categories.length - 1];\r\n          this.selectedCategoryId = new_category.id;\r\n          this.setCategoryForm(new_category);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error refreshing categories:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  async refreshCategoryDataUp() {\r\n    if (this.selectedCommerceId !== null) {\r\n      try {\r\n        const categories = await this.categoryService.getCategoriesByCommerceId(\r\n          this.selectedCommerceId\r\n        );\r\n        categories.sort((a, b) => a.id - b.id);\r\n        this.categories = categories;\r\n\r\n        if (this.selectedCategoryId) {\r\n          const latestCategory =\r\n            await this.categoryService.getCategoryByCategoryId(\r\n              this.selectedCategoryId\r\n            ); \r\n          this.setCategoryForm(latestCategory);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error refreshing categories:', error);\r\n      }\r\n    }\r\n  } \r\n\r\n  async openUpdateCategoryModal() {\r\n    let defaultCategory: any;\r\n\r\n    // Check if there is a selected category\r\n    if (this.selectedCategoryId !== null) {\r\n      // Use the selected category as the default if available\r\n      defaultCategory = this.categories.find(\r\n        (category) => category.id === this.selectedCategoryId\r\n      );\r\n    } else if (this.categories.length > 0) {\r\n      // If no selected category, use the first category from the list of categories\r\n      defaultCategory = this.categories[0];\r\n    }\r\n\r\n    // Open the modal with the default category as a prop\r\n    const modal = await this.modalController.create({\r\n      component: UpdateCategoryModalPage,\r\n      componentProps: {\r\n        category: defaultCategory,\r\n      },\r\n    });\r\n\r\n    modal.onDidDismiss().then(async (result) => {\r\n      console.log('Modal dismissed:', result);\r\n      if (result.data.dismissed === 'confirm') {\r\n        // Handle confirmation\r\n        console.log('Modal dismissed with confirm role');\r\n\r\n        // Refresh the updated category\r\n        await this.refreshCategoryDataUp();\r\n      } else if (result.data.dismissed === 'cancel') {\r\n        // Handle cancellation\r\n        console.log('Modal dismissed with cancel role');\r\n      } else {\r\n        // Handle other dismissals\r\n        console.log(\r\n          'Modal dismissed with unexpected role:',\r\n          result.data.dismissed\r\n        );\r\n      }\r\n    });\r\n\r\n    await modal.present();\r\n  }\r\n\r\n  lockApp() {\r\n    // Disable form controls or redirect to a locked page\r\n    // this.commerceForm.disable();\r\n    // Example: Show a locked message or redirect to a locked page\r\n    this.router.navigate(['/villes-commerces']);\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar>\r\n    <ion-title>Categories</ion-title>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"openUpdateCategoryModal()\" color=\"primary\">\r\n        Edit\r\n      </ion-button>\r\n    </ion-buttons>\r\n  </ion-toolbar> \r\n</ion-header>\r\n \r\n<ion-content>\r\n  <ion-grid class=\"grid-container\">\r\n    <ion-row>\r\n      <ion-col size=\"6\" class=\"column\">\r\n        commerces\r\n      </ion-col>\r\n      <ion-col size=\"6\" class=\"column\">\r\n        categories\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row>\r\n      <!-- Left column for commerces -->\r\n      <ion-col size=\"6\" class=\"column\">\r\n        <div scrolly=\"true\" style=\"max-height: 100px\">\r\n          <ion-list *ngIf=\"commerces.length > 0\" class=\"list\">\r\n            <ion-item *ngFor=\"let commerce of commerces\" class=\"item\" [class.selected-commerce]=\"commerce.id === selectedCommerceId\" (click)=\"onCommerceClick(commerce.id)\">\r\n              {{ commerce.commercename }}\r\n            </ion-item>\r\n          </ion-list>\r\n          <!-- Display message if no commerces found -->\r\n          <div *ngIf=\"commerces.length === 0\" class=\"no-commerces-message\">\r\n            <p>No commerces found.</p>\r\n          </div>\r\n        </div>\r\n      </ion-col>\r\n\r\n      <!-- Vertical border between columns -->\r\n      <!-- <ion-col size=\"1\" class=\"vertical-border\"></ion-col> -->\r\n\r\n      <!-- Right column for categories -->\r\n      <ion-col size=\"6\" class=\"column\">\r\n        <div scrolly=\"true\" style=\"max-height: 100px\">\r\n          <ion-list *ngIf=\"categories.length > 0\" class=\"list\">\r\n            <ion-item *ngFor=\"let category of categories\" class=\"item\" [class.selected-category]=\"category.id === selectedCategoryId\" (click)=\"onCategoryClick(category)\">\r\n              {{ category.categoryname }}\r\n            </ion-item>\r\n          </ion-list>\r\n          <!-- Display message if no categories found -->\r\n          <div *ngIf=\"categories.length === 0\" class=\"no-categories-message\">\r\n            <p>No categories found.</p>\r\n          </div>\r\n        </div>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n\r\n  <!-- Display form for the first category -->\r\n  <ion-card *ngIf=\"categoryForm\">\r\n    <ion-card-header>\r\n      <ion-card-title>Category Details</ion-card-title>\r\n    </ion-card-header>\r\n    <ion-card-content>\r\n      <form [formGroup]=\"categoryForm\">\r\n        <ion-item>\r\n          <!-- <ion-label>Image</ion-label> -->\r\n          <!-- Use ion-img to display the associated image -->\r\n          <ion-img [src]=\"categoryForm.get('image_category')?.value\"></ion-img>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>ID : </ion-label>\r\n          <ion-input formControlName=\"id\" readonly></ion-input>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Category Name : </ion-label>\r\n          <ion-input formControlName=\"categoryname\" readonly></ion-input>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Commerce ID : </ion-label>\r\n          <ion-input formControlName=\"commerce_id\" readonly></ion-input>\r\n        </ion-item>\r\n      </form>\r\n    </ion-card-content>\r\n  </ion-card> \r\n\r\n  <!-- Fab button -->\r\n  <ion-fab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\r\n    <ion-fab-button (click)=\"openCommerceCategoriesPage()\">\r\n      <ion-icon name=\"add\"></ion-icon>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n</ion-content>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}