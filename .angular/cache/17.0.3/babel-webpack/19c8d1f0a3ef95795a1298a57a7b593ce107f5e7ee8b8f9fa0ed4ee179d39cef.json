{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jclon/chatgptVcp/Ionic-vcp-macbook27mars22024/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\nimport { CommerceCategoriesPage } from '../commerce-categories/commerce-categories.page';\nimport { UpdateProductModalPage } from '../update-product-modal/update-product-modal.page';\nimport { ProductModalAddPage } from '../product-modal-add/product-modal-add.page'; // Import the ProductModalAddPage component\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/user.service\";\nimport * as i2 from \"src/app/services/commerce.service\";\nimport * as i3 from \"src/app/services/category.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@ionic/angular\";\nimport * as i7 from \"src/app/services/product.service\";\nimport * as i8 from \"@angular/common\";\nfunction ProductsPage_ion_list_17_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 17);\n    i0.ɵɵlistener(\"click\", function ProductsPage_ion_list_17_ion_item_1_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const commerce_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.onCommerceClick(commerce_r8.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const commerce_r8 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"selected-commerce\", commerce_r8.id === ctx_r7.selectedCommerceId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", commerce_r8.commercename, \" \");\n  }\n}\nfunction ProductsPage_ion_list_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 15);\n    i0.ɵɵtemplate(1, ProductsPage_ion_list_17_ion_item_1_Template, 2, 3, \"ion-item\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.commerces);\n  }\n}\nfunction ProductsPage_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"p\");\n    i0.ɵɵtext(2, \"No commerces found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsPage_ion_list_21_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 17);\n    i0.ɵɵlistener(\"click\", function ProductsPage_ion_list_21_ion_item_1_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const category_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.onCategoryClick(category_r12));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const category_r12 = ctx.$implicit;\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"selected-category\", category_r12.id === ctx_r11.selectedCategoryId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", category_r12.categoryname, \" \");\n  }\n}\nfunction ProductsPage_ion_list_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 15);\n    i0.ɵɵtemplate(1, ProductsPage_ion_list_21_ion_item_1_Template, 2, 3, \"ion-item\", 19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.categories);\n  }\n}\nfunction ProductsPage_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"p\");\n    i0.ɵɵtext(2, \"No categories found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsPage_ion_row_27_ion_list_3_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 17);\n    i0.ɵɵlistener(\"click\", function ProductsPage_ion_row_27_ion_list_3_ion_item_1_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const product_r18 = restoredCtx.$implicit;\n      const ctx_r19 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r19.onProductClick(product_r18.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const product_r18 = ctx.$implicit;\n    const ctx_r17 = i0.ɵɵnextContext(3);\n    i0.ɵɵclassProp(\"selected-product\", product_r18.id === ctx_r17.selectedProductId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", product_r18.productname, \" \");\n  }\n}\nfunction ProductsPage_ion_row_27_ion_list_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 15);\n    i0.ɵɵtemplate(1, ProductsPage_ion_row_27_ion_list_3_ion_item_1_Template, 2, 3, \"ion-item\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r15.products);\n  }\n}\nfunction ProductsPage_ion_row_27_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"p\");\n    i0.ɵɵtext(2, \"No products found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsPage_ion_row_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\")(1, \"ion-col\", 9)(2, \"div\", 5);\n    i0.ɵɵtemplate(3, ProductsPage_ion_row_27_ion_list_3_Template, 2, 1, \"ion-list\", 6)(4, ProductsPage_ion_row_27_div_4_Template, 3, 0, \"div\", 21);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.products.length > 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.products.length === 0);\n  }\n}\nfunction ProductsPage_ion_row_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\")(1, \"ion-col\", 24)(2, \"p\");\n    i0.ɵɵtext(3, \"No products available.\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction ProductsPage_form_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 25)(1, \"ion-item\");\n    i0.ɵɵelement(2, \"ion-img\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-item\")(4, \"ion-label\");\n    i0.ɵɵtext(5, \"Product Name : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"ion-input\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-item\")(8, \"ion-label\");\n    i0.ɵɵtext(9, \"Reference : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"ion-input\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-item\")(12, \"ion-label\");\n    i0.ɵɵtext(13, \"Price : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"ion-input\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"ion-item\")(16, \"ion-label\");\n    i0.ɵɵtext(17, \"Description : \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"ion-textarea\", 30);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    let tmp_1_0;\n    i0.ɵɵproperty(\"formGroup\", ctx_r6.productForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", (tmp_1_0 = ctx_r6.productForm.get(\"image_product\")) == null ? null : tmp_1_0.value);\n  }\n}\nexport class ProductsPage {\n  constructor(userService, commerceService, categoryService, formBuilder, router, modalController, productService) {\n    this.userService = userService;\n    this.commerceService = commerceService;\n    this.categoryService = categoryService;\n    this.formBuilder = formBuilder;\n    this.router = router;\n    this.modalController = modalController;\n    this.productService = productService;\n    this.categories = [];\n    this.commerces = [];\n    this.products = [];\n    this.selectedCommerceId = null;\n    this.categoryForm = null;\n    this.productForm = new FormGroup({});\n    this.selectedCategoryId = null;\n    this.selectedProductId = null;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Fetch business owner ID\n        const businessOwnerId = yield _this.userService.getBusinessOwnerId();\n        // Fetch commerces\n        if (businessOwnerId !== null) {\n          const monthlyFeePaid = yield _this.userService.getMonthlyFeePaidStatus(businessOwnerId);\n          if (!monthlyFeePaid) {\n            _this.lockApp();\n            return;\n          }\n          const commerces = yield _this.commerceService.getCommercesByBusinessOwnerWithMonthlyFeePaid(businessOwnerId);\n          commerces.sort((a, b) => a.id - b.id);\n          _this.commerces = commerces;\n          // Check if there are commerces in the list\n          if (_this.commerces.length > 0) {\n            // Select the first commerce by default\n            _this.selectedCommerceId = _this.commerces[0].id;\n            // Fetch categories associated with the selected commerce\n            if (_this.selectedCommerceId !== null) {\n              yield _this.fetchCategoriesByCommerceId(_this.selectedCommerceId);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching commerces:', error);\n      }\n    })();\n  }\n  onCommerceClick(commerceId) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.selectedCommerceId = commerceId;\n      yield _this2.fetchCategoriesByCommerceId(commerceId);\n    })();\n  }\n  fetchCategoriesByCommerceId(commerceId) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Fetch categories associated with the selected commerce\n        const categories = yield _this3.categoryService.getCategoriesByCommerceId(commerceId);\n        categories.sort((a, b) => a.id - b.id);\n        _this3.categories = categories;\n        if (_this3.categories.length > 0) {\n          // Select the first category by default\n          _this3.selectedCategoryId = _this3.categories[0].id;\n          // Display details of the first category\n          _this3.setCategoryForm(_this3.categories[0]);\n          if (_this3.selectedCategoryId !== null) {\n            // Fetch and display products associated with the selected category\n            yield _this3.fetchProductsByCategoryId(_this3.selectedCategoryId);\n          } else {\n            console.error('Selected category ID is null.');\n          }\n        } else {\n          yield _this3.fetchProductsByCategoryId(-1);\n          // Reset the category form if no categories found\n          _this3.clearProductForm();\n        }\n      } catch (error) {\n        console.error('Error fetching categories:', error);\n      }\n    })();\n  }\n  fetchProductsByCategoryId(categoryId) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Fetch products associated with the selected category\n        const products = yield _this4.productService.getProductsByCategoryId(categoryId);\n        products.sort((a, b) => a.id - b.id);\n        _this4.products = products;\n        if (_this4.products.length > 0) {\n          // Select the first product by default\n          _this4.selectedProductId = _this4.products[0].id; // Set selectedProductId to the ID of the first product\n          // Display details of the first product\n          // this.setSelectedProductDetails(this.products[0]); // Call a method to set selected product details\n          // this.setCategoryForm(this.categories[0]);\n          _this4.setProductForm(_this4.products[0]);\n        } else {\n          const empty_product = {\n            productname: '',\n            reference: '',\n            price: '',\n            description: '',\n            image_product: ''\n          };\n          _this4.setProductForm(empty_product);\n          console.error('No products found.');\n        }\n      } catch (error) {\n        console.error('Error fetching products:', error);\n      }\n    })();\n  }\n  // Method to set selected product details\n  setSelectedProductDetails(product) {\n    this.selectedProductId = product.id;\n    if (this.selectedProductId) console.log('', this.fetchProductDetails(this.selectedProductId));\n  }\n  clearProductForm() {\n    this.productForm?.reset();\n  }\n  onCategoryClick(category) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      // Set the selected category ID\n      _this5.selectedCategoryId = category.id;\n      // Set the form for the clicked category\n      // this.setCategoryForm(category);\n      if (_this5.selectedCategoryId !== null) {\n        // Fetch and display products associated with the clicked category\n        yield _this5.fetchProductsByCategoryId(_this5.selectedCategoryId);\n      } else {\n        _this5.clearProductForm();\n        yield _this5.fetchProductsByCategoryId(-1);\n        console.error('Selected category ID is null.');\n      }\n    })();\n  }\n  setCategoryForm(category) {\n    const formGroup = {};\n    // Iterate through each category field and create form control\n    Object.keys(category).forEach(key => {\n      formGroup[key] = new FormControl(category[key], Validators.required);\n    });\n    this.categoryForm = new FormGroup(formGroup);\n  }\n  setProductForm(product) {\n    this.productForm = new FormGroup({\n      productname: new FormControl(product.productname, Validators.required),\n      reference: new FormControl(product.reference, Validators.required),\n      price: new FormControl(product.price, Validators.required),\n      description: new FormControl(product.description, Validators.required),\n      image_product: new FormControl(product.image_product, Validators.required)\n    });\n  }\n  onProductClick(productId) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      const productDetails = yield _this6.productService.getProductById(productId);\n      _this6.selectedProductId = productId;\n      if (productDetails) {\n        _this6.setProductForm(productDetails);\n      } else {\n        console.error('Failed to fetch product details.');\n      }\n    })();\n  }\n  fetchProductDetails(productId) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      // Call ProductService to get product details\n      const productDetails = yield _this7.productService.getProductById(productId);\n      if (productDetails) {\n        // Do something with the product details, such as displaying them in the UI\n        console.log('Product details:', productDetails);\n      } else {\n        console.error('Failed to fetch product details.');\n      }\n    })();\n  }\n  // Method to open CommerceCategories modal\n  openCommerceCategoriesPage() {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      if (_this8.selectedCommerceId !== null) {\n        // Fetch the complete commerce object using the ID\n        const commerce = yield _this8.commerceService.getCommerceById(_this8.selectedCommerceId);\n        if (commerce) {\n          const modal = yield _this8.modalController.create({\n            component: CommerceCategoriesPage,\n            componentProps: {\n              business_owner_id: commerce.business_owner_id,\n              ville_id: commerce.ville_id,\n              commerce_id: commerce.id\n            }\n          });\n          modal.onDidDismiss().then(result => {\n            console.log('Modal dismissed:', result);\n            if (result.data.dismissed === 'confirm') {\n              // Handle confirmation\n              console.log('Modal dismissed with confirm role');\n              // For example, refresh category data\n              _this8.refreshCategoryData();\n            } else if (result.data.dismissed === 'cancel') {\n              // Handle cancellation\n              console.log('Modal dismissed with cancel role');\n            } else {\n              // Handle other dismissals\n              console.log('Modal dismissed with unexpected role:', result.data.dismissed);\n            }\n          });\n          return yield modal.present();\n        }\n      }\n    })();\n  }\n  refreshCategoryData() {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      if (_this9.selectedCommerceId !== null) {\n        try {\n          const newCategories = yield _this9.categoryService.getCategoriesByCommerceId(_this9.selectedCommerceId);\n          if (newCategories.length > 0) {\n            // Retrieve the latest category\n            const latestCategory = newCategories[0];\n            // Find the index of the former category in the categories array\n            const index = _this9.categories.findIndex(category => category.id === latestCategory.id);\n            if (index !== -1) {\n              // Replace the former category with the updated category\n              _this9.categories[index] = latestCategory;\n            } else {\n              // If the former category is not found in the array, add the updated category\n              _this9.categories.unshift(latestCategory);\n            }\n          }\n        } catch (error) {\n          console.error('Error refreshing categories:', error);\n        }\n      }\n    })();\n  }\n  openUpdateProductModal() {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this10.selectedProductId !== null) {\n          // Fetch the current product\n          const product = yield _this10.productService.getProductById(_this10.selectedProductId);\n          // Create the modal with the current product as props\n          const modal = yield _this10.modalController.create({\n            component: UpdateProductModalPage,\n            componentProps: {\n              product: product // Pass the current product as props\n            }\n          });\n\n          modal.onDidDismiss().then( /*#__PURE__*/function () {\n            var _ref = _asyncToGenerator(function* (result) {\n              console.log('Modal dismissed:', result);\n              if (result.data.dismissed === 'confirm') {\n                // Handle confirmation\n                console.log('Modal dismissed with confirm role');\n                // For example, refresh product data\n                yield _this10.refreshProductDataUp();\n              } else if (result.data.dismissed === 'cancel') {\n                // Handle cancellation\n                console.log('Modal dismissed with cancel role');\n              } else {\n                // Handle other dismissals\n                console.log('Modal dismissed with unexpected role:', result.data.dismissed);\n              }\n            });\n            return function (_x) {\n              return _ref.apply(this, arguments);\n            };\n          }());\n          // Display the modal\n          yield modal.present();\n        } else {\n          console.error('Selected product ID is null.');\n        }\n      } catch (error) {\n        console.error('Error opening update product modal:', error);\n      }\n    })();\n  }\n  lockApp() {\n    this.router.navigate(['/villes-commerces']);\n  }\n  openProductModalAddPage() {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this11.selectedCategoryId !== null) {\n          // Fetch the current category\n          const category = yield _this11.categoryService.getCategoryByCategoryId(_this11.selectedCategoryId);\n          // Create the modal with the current category as props\n          const modal = yield _this11.modalController.create({\n            component: ProductModalAddPage,\n            componentProps: {\n              category: category // Pass the current category as props\n            }\n          });\n\n          modal.onDidDismiss().then(result => {\n            console.log('Modal dismissed:', result);\n            if (result.data.dismissed === 'confirm') {\n              // Handle confirmation\n              console.log('Modal dismissed with confirm role');\n              // For example, refresh category data\n              _this11.refreshProductData();\n            } else if (result.data.dismissed === 'cancel') {\n              // Handle cancellation\n              console.log('Modal dismissed with cancel role');\n            } else {\n              // Handle other dismissals\n              console.log('Modal dismissed with unexpected role:', result.data.dismissed);\n            }\n          });\n          // Display the modal\n          yield modal.present();\n        } else {\n          console.error('Selected category ID is null.');\n        }\n      } catch (error) {\n        console.error('Error opening product modal:', error);\n      }\n    })();\n  }\n  refreshProductData() {\n    var _this12 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this12.selectedCategoryId !== null) {\n          // Fetch the updated list of products for the current category\n          _this12.products = yield _this12.productService.getProductsByCategoryId(_this12.selectedCategoryId);\n          _this12.products.sort((a, b) => a.id - b.id);\n          if (_this12.products.length > 0) {\n            const new_product = _this12.products[_this12.products.length - 1];\n            _this12.selectedProductId = new_product.id;\n            _this12.setProductForm(new_product);\n          }\n        }\n      } catch (error) {\n        console.error('Error refreshing products:', error);\n      }\n    })();\n  }\n  refreshProductDataUp() {\n    var _this13 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this13.selectedCategoryId !== null) {\n          // Fetch the updated list of products for the current category\n          _this13.products = yield _this13.productService.getProductsByCategoryId(_this13.selectedCategoryId);\n          _this13.products.sort((a, b) => a.id - b.id);\n          if (_this13.selectedProductId) {\n            const latestProduct = yield _this13.productService.getProductById(_this13.selectedProductId);\n            _this13.setProductForm(latestProduct);\n          }\n        }\n      } catch (error) {\n        console.error('Error refreshing products:', error);\n      }\n    })();\n  }\n  static #_ = this.ɵfac = function ProductsPage_Factory(t) {\n    return new (t || ProductsPage)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.CommerceService), i0.ɵɵdirectiveInject(i3.CategoryService), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.ModalController), i0.ɵɵdirectiveInject(i7.ProductService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsPage,\n    selectors: [[\"app-products\"]],\n    decls: 33,\n    vars: 7,\n    consts: [[\"slot\", \"end\"], [\"color\", \"primary\", 3, \"click\"], [\"padding\", \"\"], [1, \"grid-container\"], [\"size\", \"6\", 1, \"column\"], [\"scrolly\", \"true\", 2, \"max-height\", \"100px\"], [\"class\", \"list\", 4, \"ngIf\"], [\"class\", \"no-commerces-message\", 4, \"ngIf\"], [\"class\", \"no-categories-message\", 4, \"ngIf\"], [\"size\", \"12\", 1, \"column\"], [4, \"ngIf\"], [3, \"formGroup\", 4, \"ngIf\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\"], [3, \"click\"], [\"name\", \"add\"], [1, \"list\"], [\"class\", \"item\", 3, \"selected-commerce\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"item\", 3, \"click\"], [1, \"no-commerces-message\"], [\"class\", \"item\", 3, \"selected-category\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"no-categories-message\"], [\"class\", \"no-products-message\", 4, \"ngIf\"], [\"class\", \"item\", 3, \"selected-product\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"no-products-message\"], [\"size\", \"12\"], [3, \"formGroup\"], [3, \"src\"], [\"formControlName\", \"productname\", \"readonly\", \"\"], [\"formControlName\", \"reference\", \"readonly\", \"\"], [\"formControlName\", \"price\", \"type\", \"number\", \"readonly\", \"\"], [\"formControlName\", \"description\", \"readonly\", \"\"]],\n    template: function ProductsPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n        i0.ɵɵtext(3, \"Products\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-buttons\", 0)(5, \"ion-button\", 1);\n        i0.ɵɵlistener(\"click\", function ProductsPage_Template_ion_button_click_5_listener() {\n          return ctx.openUpdateProductModal();\n        });\n        i0.ɵɵtext(6, \" Edit \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(7, \"ion-content\", 2)(8, \"ion-grid\", 3)(9, \"ion-row\")(10, \"ion-col\", 4);\n        i0.ɵɵtext(11, \" commerces \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"ion-col\", 4);\n        i0.ɵɵtext(13, \" categories \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"ion-row\")(15, \"ion-col\", 4)(16, \"div\", 5);\n        i0.ɵɵtemplate(17, ProductsPage_ion_list_17_Template, 2, 1, \"ion-list\", 6)(18, ProductsPage_div_18_Template, 3, 0, \"div\", 7);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"ion-col\", 4)(20, \"div\", 5);\n        i0.ɵɵtemplate(21, ProductsPage_ion_list_21_Template, 2, 1, \"ion-list\", 6)(22, ProductsPage_div_22_Template, 3, 0, \"div\", 8);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(23, \"ion-grid\", 3)(24, \"ion-row\")(25, \"ion-col\", 9);\n        i0.ɵɵtext(26, \" products \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(27, ProductsPage_ion_row_27_Template, 5, 2, \"ion-row\", 10)(28, ProductsPage_ion_row_28_Template, 4, 0, \"ion-row\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(29, ProductsPage_form_29_Template, 19, 2, \"form\", 11);\n        i0.ɵɵelementStart(30, \"ion-fab\", 12)(31, \"ion-fab-button\", 13);\n        i0.ɵɵlistener(\"click\", function ProductsPage_Template_ion_fab_button_click_31_listener() {\n          return ctx.openProductModalAddPage();\n        });\n        i0.ɵɵelement(32, \"ion-icon\", 14);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"ngIf\", ctx.commerces.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.commerces.length === 0);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.categories.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.categories.length === 0);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.products.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.products.length === 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedProductId);\n      }\n    },\n    dependencies: [i8.NgForOf, i8.NgIf, i4.ɵNgNoValidate, i4.NgControlStatus, i4.NgControlStatusGroup, i6.IonButton, i6.IonButtons, i6.IonCol, i6.IonContent, i6.IonFab, i6.IonFabButton, i6.IonGrid, i6.IonHeader, i6.IonIcon, i6.IonImg, i6.IonInput, i6.IonItem, i6.IonLabel, i6.IonList, i6.IonRow, i6.IonTextarea, i6.IonTitle, i6.IonToolbar, i6.NumericValueAccessor, i6.TextValueAccessor, i4.FormGroupDirective, i4.FormControlName],\n    styles: [\"div[scrolly=true][_ngcontent-%COMP%] {\\n  overflow-y: auto;\\n  max-height: 200px; \\n\\n}\\n\\n.grid-container[_ngcontent-%COMP%] {\\n  border: 1px solid #ccc; \\n\\n}\\n\\n.selected-commerce[_ngcontent-%COMP%] {\\n  --ion-item-background: #f0f8ff; \\n\\n}\\n\\nion-item.selected-category[_ngcontent-%COMP%] {\\n  --ion-item-background: #f3e6d5; \\n\\n}\\n\\n.selected-product[_ngcontent-%COMP%] {\\n  --ion-item-background: #eee4eb; \\n\\n}\\n\\n.selected-detail[_ngcontent-%COMP%] {\\n  --ion-item-background: #e0edf8; \\n\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvcHJvZHVjdHMvcHJvZHVjdHMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZ0JBQUE7RUFDQSxpQkFBQSxFQUFBLGtEQUFBO0FBQ0Y7O0FBR0E7RUFDSSxzQkFBQSxFQUFBLDJCQUFBO0FBQUo7O0FBUUE7RUFDRSw4QkFBQSxFQUFBLDBCQUFBO0FBTEY7O0FBUUE7RUFDRSw4QkFBQSxFQUFBLDJCQUFBO0FBTEY7O0FBUUE7RUFDRSw4QkFBQSxFQUFBLDBCQUFBO0FBTEY7O0FBUUE7RUFDRSw4QkFBQSxFQUFBLDBCQUFBO0FBTEYiLCJzb3VyY2VzQ29udGVudCI6WyJkaXZbc2Nyb2xseT1cInRydWVcIl0ge1xyXG4gIG92ZXJmbG93LXk6IGF1dG87XHJcbiAgbWF4LWhlaWdodDogMjAwcHg7IC8qIFRoaXMgc2hvdWxkIG1hdGNoIHRoZSBtYXgtaGVpZ2h0IGluIHlvdXIgSFRNTCAqL1xyXG59XHJcblxyXG4gIFxyXG4uZ3JpZC1jb250YWluZXIge1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsgLyogQm9yZGVyIGFyb3VuZCB0aGUgZ3JpZCAqL1xyXG59XHJcbiAgXHJcbiAgXHJcblxyXG5cclxuXHJcblxyXG4uc2VsZWN0ZWQtY29tbWVyY2Uge1xyXG4gIC0taW9uLWl0ZW0tYmFja2dyb3VuZDogI2YwZjhmZjsgLyogTGlnaHQgYmx1ZS1ncmV5IGNvbG9yICovXHJcbn1cclxuXHJcbmlvbi1pdGVtLnNlbGVjdGVkLWNhdGVnb3J5IHtcclxuICAtLWlvbi1pdGVtLWJhY2tncm91bmQ6ICNmM2U2ZDU7IC8qIExpZ2h0IGJyb3duLWdyZXkgY29sb3IgKi9cclxufVxyXG5cclxuLnNlbGVjdGVkLXByb2R1Y3Qge1xyXG4gIC0taW9uLWl0ZW0tYmFja2dyb3VuZDogI2VlZTRlYjsgLyogTGlnaHQgYmx1ZS1ncmV5IGNvbG9yICovXHJcbn1cclxuXHJcbi5zZWxlY3RlZC1kZXRhaWwge1xyXG4gIC0taW9uLWl0ZW0tYmFja2dyb3VuZDogI2UwZWRmODsgLyogTGlnaHQgYmx1ZS1ncmV5IGNvbG9yICovXHJcbn0gIFxyXG5cclxuXHJcbiAgIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["FormGroup","Validators","FormControl","CommerceCategoriesPage","UpdateProductModalPage","ProductModalAddPage","i0","ɵɵelementStart","ɵɵlistener","ProductsPage_ion_list_17_ion_item_1_Template_ion_item_click_0_listener","restoredCtx","ɵɵrestoreView","_r10","commerce_r8","$implicit","ctx_r9","ɵɵnextContext","ɵɵresetView","onCommerceClick","id","ɵɵtext","ɵɵelementEnd","ɵɵclassProp","ctx_r7","selectedCommerceId","ɵɵadvance","ɵɵtextInterpolate1","commercename","ɵɵtemplate","ProductsPage_ion_list_17_ion_item_1_Template","ɵɵproperty","ctx_r0","commerces","ProductsPage_ion_list_21_ion_item_1_Template_ion_item_click_0_listener","_r14","category_r12","ctx_r13","onCategoryClick","ctx_r11","selectedCategoryId","categoryname","ProductsPage_ion_list_21_ion_item_1_Template","ctx_r2","categories","ProductsPage_ion_row_27_ion_list_3_ion_item_1_Template_ion_item_click_0_listener","_r20","product_r18","ctx_r19","onProductClick","ctx_r17","selectedProductId","productname","ProductsPage_ion_row_27_ion_list_3_ion_item_1_Template","ctx_r15","products","ProductsPage_ion_row_27_ion_list_3_Template","ProductsPage_ion_row_27_div_4_Template","ctx_r4","length","ɵɵelement","ctx_r6","productForm","tmp_1_0","get","value","ProductsPage","constructor","userService","commerceService","categoryService","formBuilder","router","modalController","productService","categoryForm","ngOnInit","_this","_asyncToGenerator","businessOwnerId","getBusinessOwnerId","monthlyFeePaid","getMonthlyFeePaidStatus","lockApp","getCommercesByBusinessOwnerWithMonthlyFeePaid","sort","a","b","fetchCategoriesByCommerceId","error","console","commerceId","_this2","_this3","getCategoriesByCommerceId","setCategoryForm","fetchProductsByCategoryId","clearProductForm","categoryId","_this4","getProductsByCategoryId","setProductForm","empty_product","reference","price","description","image_product","setSelectedProductDetails","product","log","fetchProductDetails","reset","category","_this5","formGroup","Object","keys","forEach","key","required","productId","_this6","productDetails","getProductById","_this7","openCommerceCategoriesPage","_this8","commerce","getCommerceById","modal","create","component","componentProps","business_owner_id","ville_id","commerce_id","onDidDismiss","then","result","data","dismissed","refreshCategoryData","present","_this9","newCategories","latestCategory","index","findIndex","unshift","openUpdateProductModal","_this10","_ref","refreshProductDataUp","_x","apply","arguments","navigate","openProductModalAddPage","_this11","getCategoryByCategoryId","refreshProductData","_this12","new_product","_this13","latestProduct","_","ɵɵdirectiveInject","i1","UserService","i2","CommerceService","i3","CategoryService","i4","FormBuilder","i5","Router","i6","ModalController","i7","ProductService","_2","selectors","decls","vars","consts","template","ProductsPage_Template","rf","ctx","ProductsPage_Template_ion_button_click_5_listener","ProductsPage_ion_list_17_Template","ProductsPage_div_18_Template","ProductsPage_ion_list_21_Template","ProductsPage_div_22_Template","ProductsPage_ion_row_27_Template","ProductsPage_ion_row_28_Template","ProductsPage_form_29_Template","ProductsPage_Template_ion_fab_button_click_31_listener"],"sources":["C:\\Users\\jclon\\chatgptVcp\\Ionic-vcp-macbook27mars22024\\src\\app\\pages\\products\\products.page.ts","C:\\Users\\jclon\\chatgptVcp\\Ionic-vcp-macbook27mars22024\\src\\app\\pages\\products\\products.page.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { UserService } from 'src/app/services/user.service';\r\nimport { CommerceService } from 'src/app/services/commerce.service';\r\nimport { CategoryService } from 'src/app/services/category.service'; // Import CategoryService\r\nimport {\r\n  FormBuilder,\r\n  FormGroup,\r\n  Validators,\r\n  FormControl,\r\n} from '@angular/forms';\r\nimport { CommerceCategoriesPage } from '../commerce-categories/commerce-categories.page';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { UpdateProductModalPage } from '../update-product-modal/update-product-modal.page';\r\nimport { Router } from '@angular/router';\r\nimport { ProductModalAddPage } from '../product-modal-add/product-modal-add.page'; // Import the ProductModalAddPage component\r\nimport { ProductService } from 'src/app/services/product.service'; // Import the ProductService\r\n\r\n@Component({\r\n  selector: 'app-products',\r\n  templateUrl: './products.page.html',\r\n  styleUrls: ['./products.page.scss'],\r\n})\r\nexport class ProductsPage implements OnInit {\r\n  categories: any[] = [];\r\n  commerces: any[] = [];\r\n  products: any[] = [];\r\n  selectedCommerceId: number | null = null;\r\n  categoryForm: FormGroup | null = null;\r\n  productForm: FormGroup = new FormGroup({});\r\n\r\n  selectedCategoryId: number | null = null;\r\n  selectedProductId: number | null = null;\r\n\r\n  constructor(\r\n    private userService: UserService,\r\n    private commerceService: CommerceService,\r\n    private categoryService: CategoryService,\r\n    private formBuilder: FormBuilder,\r\n    private router: Router,\r\n    private modalController: ModalController,\r\n    private productService: ProductService\r\n  ) {}\r\n\r\n  async ngOnInit() {\r\n    try {\r\n      // Fetch business owner ID\r\n      const businessOwnerId = await this.userService.getBusinessOwnerId();\r\n\r\n      // Fetch commerces\r\n      if (businessOwnerId !== null) {\r\n        const monthlyFeePaid = await this.userService.getMonthlyFeePaidStatus(\r\n          businessOwnerId\r\n        );\r\n        if (!monthlyFeePaid) {\r\n          this.lockApp();\r\n          return;\r\n        }\r\n        const commerces =\r\n          await this.commerceService.getCommercesByBusinessOwnerWithMonthlyFeePaid(\r\n            businessOwnerId\r\n          );\r\n \r\n        commerces.sort((a, b) => a.id - b.id);\r\n        this.commerces = commerces;\r\n\r\n        // Check if there are commerces in the list\r\n        if (this.commerces.length > 0) {\r\n          // Select the first commerce by default\r\n          this.selectedCommerceId = this.commerces[0].id;\r\n          // Fetch categories associated with the selected commerce\r\n          if (this.selectedCommerceId !== null) {\r\n            await this.fetchCategoriesByCommerceId(this.selectedCommerceId);\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching commerces:', error);\r\n    }\r\n  }\r\n\r\n  async onCommerceClick(commerceId: number) {\r\n    this.selectedCommerceId = commerceId;\r\n    await this.fetchCategoriesByCommerceId(commerceId);\r\n  }\r\n\r\n  async fetchCategoriesByCommerceId(commerceId: number) {\r\n    try {\r\n      // Fetch categories associated with the selected commerce\r\n      const categories = await this.categoryService.getCategoriesByCommerceId(\r\n        commerceId\r\n      );\r\n\r\n      categories.sort((a, b) => a.id - b.id);\r\n      this.categories = categories;\r\n\r\n      if (this.categories.length > 0) {\r\n        // Select the first category by default\r\n        this.selectedCategoryId = this.categories[0].id;\r\n        // Display details of the first category\r\n        this.setCategoryForm(this.categories[0]);\r\n\r\n        if (this.selectedCategoryId !== null) {\r\n          // Fetch and display products associated with the selected category\r\n          await this.fetchProductsByCategoryId(this.selectedCategoryId);\r\n        } else {\r\n          console.error('Selected category ID is null.');\r\n        }\r\n      } else {\r\n        await this.fetchProductsByCategoryId(-1);\r\n        // Reset the category form if no categories found\r\n        this.clearProductForm();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching categories:', error);\r\n    }\r\n  }\r\n\r\n  async fetchProductsByCategoryId(categoryId: number) {\r\n    try {\r\n      // Fetch products associated with the selected category\r\n      const products = await this.productService.getProductsByCategoryId(\r\n        categoryId\r\n      );\r\n\r\n      products.sort((a, b) => a.id - b.id);\r\n      this.products = products;\r\n\r\n      if (this.products.length > 0) {\r\n        // Select the first product by default\r\n        this.selectedProductId = this.products[0].id; // Set selectedProductId to the ID of the first product\r\n        // Display details of the first product\r\n        // this.setSelectedProductDetails(this.products[0]); // Call a method to set selected product details\r\n        // this.setCategoryForm(this.categories[0]);\r\n        this.setProductForm(this.products[0])\r\n      } else {\r\n      const empty_product = {\r\n        productname: '',\r\n        reference: '',\r\n        price: '',\r\n        description: '',\r\n        image_product: ''\r\n      };\r\n        this.setProductForm(empty_product);\r\n        console.error('No products found.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching products:', error);\r\n    }\r\n  }\r\n\r\n  // Method to set selected product details\r\n  setSelectedProductDetails(product: any) {\r\n    this.selectedProductId = product.id; \r\n    if (this.selectedProductId)\r\n    console.log('', this.fetchProductDetails(this.selectedProductId))\r\n  }\r\n\r\n  clearProductForm() {\r\n    this.productForm?.reset();\r\n  }\r\n\r\n  async onCategoryClick(category: any) {\r\n    // Set the selected category ID\r\n    this.selectedCategoryId = category.id;\r\n    // Set the form for the clicked category\r\n    // this.setCategoryForm(category);\r\n\r\n    if (this.selectedCategoryId !== null) {\r\n      // Fetch and display products associated with the clicked category\r\n      await this.fetchProductsByCategoryId(this.selectedCategoryId);\r\n    } else {\r\n      this.clearProductForm()\r\n      await this.fetchProductsByCategoryId(-1);\r\n      console.error('Selected category ID is null.');\r\n    }\r\n  }\r\n\r\n  setCategoryForm(category: any) {\r\n    const formGroup: any = {};\r\n\r\n    // Iterate through each category field and create form control\r\n    Object.keys(category).forEach((key) => {\r\n      formGroup[key] = new FormControl(category[key], Validators.required);\r\n    });\r\n\r\n    this.categoryForm = new FormGroup(formGroup);\r\n  }\r\n\r\n  setProductForm(product: any) {\r\n    this.productForm = new FormGroup({\r\n      productname: new FormControl(product.productname, Validators.required),\r\n      reference: new FormControl(product.reference, Validators.required),\r\n      price: new FormControl(product.price, Validators.required),\r\n      description: new FormControl(product.description, Validators.required),\r\n      image_product: new FormControl(product.image_product, Validators.required)\r\n    });\r\n  }\r\n  \r\n\r\n  async onProductClick(productId: number) {\r\n    const productDetails = await this.productService.getProductById(productId);\r\n    this.selectedProductId = productId; \r\n    if (productDetails) {\r\n      this.setProductForm(productDetails) \r\n    } else {\r\n      console.error('Failed to fetch product details.');\r\n    }\r\n  }\r\n\r\n  async fetchProductDetails(productId: number) {\r\n    // Call ProductService to get product details\r\n    const productDetails = await this.productService.getProductById(productId);\r\n    if (productDetails) {\r\n      // Do something with the product details, such as displaying them in the UI\r\n      console.log('Product details:', productDetails);\r\n    } else {\r\n      console.error('Failed to fetch product details.');\r\n    }\r\n  }\r\n  \r\n\r\n  // Method to open CommerceCategories modal\r\n  async openCommerceCategoriesPage() {\r\n    if (this.selectedCommerceId !== null) {\r\n      // Fetch the complete commerce object using the ID\r\n      const commerce = await this.commerceService.getCommerceById(\r\n        this.selectedCommerceId\r\n      );\r\n      if (commerce) {\r\n        const modal = await this.modalController.create({\r\n          component: CommerceCategoriesPage,\r\n          componentProps: {\r\n            business_owner_id: commerce.business_owner_id,\r\n            ville_id: commerce.ville_id,\r\n            commerce_id: commerce.id,\r\n          },\r\n        });\r\n\r\n        modal.onDidDismiss().then((result) => {\r\n          console.log('Modal dismissed:', result);\r\n          if (result.data.dismissed === 'confirm') {\r\n            // Handle confirmation\r\n            console.log('Modal dismissed with confirm role');\r\n            // For example, refresh category data\r\n            this.refreshCategoryData();\r\n          } else if (result.data.dismissed === 'cancel') {\r\n            // Handle cancellation\r\n            console.log('Modal dismissed with cancel role');\r\n          } else {\r\n            // Handle other dismissals\r\n            console.log(\r\n              'Modal dismissed with unexpected role:',\r\n              result.data.dismissed\r\n            );\r\n          }\r\n        });\r\n\r\n        return await modal.present();\r\n      }\r\n    }\r\n  }\r\n\r\n  async refreshCategoryData() {\r\n    if (this.selectedCommerceId !== null) {\r\n      try {\r\n        const newCategories =\r\n          await this.categoryService.getCategoriesByCommerceId(\r\n            this.selectedCommerceId\r\n          );\r\n        if (newCategories.length > 0) {\r\n          // Retrieve the latest category\r\n          const latestCategory = newCategories[0];\r\n\r\n          // Find the index of the former category in the categories array\r\n          const index = this.categories.findIndex(\r\n            (category) => category.id === latestCategory.id\r\n          );\r\n\r\n          if (index !== -1) {\r\n            // Replace the former category with the updated category\r\n            this.categories[index] = latestCategory;\r\n          } else {\r\n            // If the former category is not found in the array, add the updated category\r\n            this.categories.unshift(latestCategory);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error refreshing categories:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  async openUpdateProductModal() {\r\n    try {\r\n      if (this.selectedProductId !== null) {\r\n        // Fetch the current product\r\n        const product = await this.productService.getProductById(this.selectedProductId);\r\n  \r\n        // Create the modal with the current product as props\r\n        const modal = await this.modalController.create({\r\n          component: UpdateProductModalPage,\r\n          componentProps: {\r\n            product: product, // Pass the current product as props\r\n          },\r\n        }); \r\n  \r\n        modal.onDidDismiss().then(async (result) => {\r\n          console.log('Modal dismissed:', result);\r\n          if (result.data.dismissed === 'confirm') {\r\n            // Handle confirmation\r\n            console.log('Modal dismissed with confirm role');\r\n            // For example, refresh product data\r\n            await this.refreshProductDataUp();\r\n          } else if (result.data.dismissed === 'cancel') {\r\n            // Handle cancellation\r\n            console.log('Modal dismissed with cancel role');\r\n          } else {\r\n            // Handle other dismissals\r\n            console.log(\r\n              'Modal dismissed with unexpected role:',\r\n              result.data.dismissed\r\n            );\r\n          }\r\n        }); \r\n   \r\n        // Display the modal\r\n        await modal.present();\r\n      } else {\r\n        console.error('Selected product ID is null.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error opening update product modal:', error);\r\n    }\r\n  }\r\n  \r\n\r\n  lockApp() {\r\n    this.router.navigate(['/villes-commerces']);\r\n  }\r\n\r\n  async openProductModalAddPage() {\r\n    try {\r\n      if (this.selectedCategoryId !== null) {\r\n        // Fetch the current category\r\n        const category = await this.categoryService.getCategoryByCategoryId(\r\n          this.selectedCategoryId\r\n        );\r\n\r\n        // Create the modal with the current category as props\r\n        const modal = await this.modalController.create({\r\n          component: ProductModalAddPage,\r\n          componentProps: {\r\n            category: category, // Pass the current category as props\r\n          },\r\n        });\r\n\r\n        modal.onDidDismiss().then((result) => {\r\n          console.log('Modal dismissed:', result);\r\n          if (result.data.dismissed === 'confirm') {\r\n            // Handle confirmation\r\n            console.log('Modal dismissed with confirm role');\r\n            // For example, refresh category data\r\n            this.refreshProductData();\r\n          } else if (result.data.dismissed === 'cancel') {\r\n            // Handle cancellation\r\n            console.log('Modal dismissed with cancel role');\r\n          } else {\r\n            // Handle other dismissals\r\n            console.log(\r\n              'Modal dismissed with unexpected role:',\r\n              result.data.dismissed\r\n            );\r\n          }\r\n        });\r\n\r\n        // Display the modal\r\n        await modal.present();\r\n      } else {\r\n        console.error('Selected category ID is null.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error opening product modal:', error);\r\n    }\r\n  }\r\n\r\n  async refreshProductData() {\r\n    try {\r\n      if (this.selectedCategoryId !== null) {\r\n        // Fetch the updated list of products for the current category\r\n        this.products = await this.productService.getProductsByCategoryId(\r\n          this.selectedCategoryId\r\n        );\r\n\r\n        this.products.sort((a, b) => a.id - b.id);\r\n\r\n        if (this.products.length > 0) {\r\n          const new_product = this.products[this.products.length - 1];\r\n          this.selectedProductId = new_product.id;\r\n          this.setProductForm(new_product);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error refreshing products:', error);\r\n    }\r\n  }\r\n\r\n  async refreshProductDataUp() {\r\n    try {\r\n      if (this.selectedCategoryId !== null) {\r\n        // Fetch the updated list of products for the current category\r\n        this.products = await this.productService.getProductsByCategoryId(\r\n          this.selectedCategoryId\r\n        );\r\n\r\n        this.products.sort((a, b) => a.id - b.id);\r\n\r\n        if (this.selectedProductId) {\r\n          const latestProduct =\r\n            await this.productService.getProductById(\r\n              this.selectedProductId\r\n            ); \r\n          this.setProductForm(latestProduct);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error refreshing products:', error);\r\n    }\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar>\r\n    <ion-title>Products</ion-title>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"openUpdateProductModal()\" color=\"primary\">\r\n        Edit\r\n      </ion-button>\r\n    </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content padding>\r\n  <ion-grid class=\"grid-container\">\r\n    <ion-row>\r\n      <ion-col size=\"6\" class=\"column\">\r\n        commerces\r\n      </ion-col>\r\n      <ion-col size=\"6\" class=\"column\">\r\n        categories\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row>\r\n      <!-- Left column for commerces -->\r\n      <ion-col size=\"6\" class=\"column\">\r\n        <div scrolly=\"true\" style=\"max-height: 100px\">\r\n          <ion-list *ngIf=\"commerces.length > 0\" class=\"list\">\r\n            <ion-item *ngFor=\"let commerce of commerces\" class=\"item\" [class.selected-commerce]=\"commerce.id === selectedCommerceId\" (click)=\"onCommerceClick(commerce.id)\">\r\n              {{ commerce.commercename }}\r\n            </ion-item>\r\n          </ion-list>\r\n          <!-- Display message if no commerces found -->\r\n          <div *ngIf=\"commerces.length === 0\" class=\"no-commerces-message\">\r\n            <p>No commerces found.</p>\r\n          </div>\r\n        </div>\r\n      </ion-col>\r\n\r\n      <!-- Vertical border between columns -->\r\n      <!-- <ion-col size=\"1\" class=\"vertical-border\"></ion-col> -->\r\n\r\n      <!-- Right column for categories -->\r\n      <ion-col size=\"6\" class=\"column\">\r\n        <div scrolly=\"true\" style=\"max-height: 100px\">\r\n          <ion-list *ngIf=\"categories.length > 0\" class=\"list\">\r\n            <ion-item *ngFor=\"let category of categories\" class=\"item\" [class.selected-category]=\"category.id === selectedCategoryId\" (click)=\"onCategoryClick(category)\">\r\n              {{ category.categoryname }}\r\n            </ion-item>\r\n          </ion-list>\r\n          <!-- Display message if no categories found -->\r\n          <div *ngIf=\"categories.length === 0\" class=\"no-categories-message\">\r\n            <p>No categories found.</p>\r\n          </div>\r\n        </div>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n\r\n  <ion-grid class=\"grid-container\">\r\n    <ion-row>\r\n      <ion-col size=\"12\" class=\"column\">\r\n        products\r\n      </ion-col>\r\n      \r\n    </ion-row>\r\n    <ion-row *ngIf=\"products.length > 0\">\r\n      <ion-col size=\"12\" class=\"column\">\r\n        <div scrolly=\"true\" style=\"max-height: 100px\">\r\n          <ion-list *ngIf=\"products.length > 0\" class=\"list\">\r\n            <ion-item *ngFor=\"let product of products\" class=\"item\" [class.selected-product]=\"product.id === selectedProductId\" (click)=\"onProductClick(product.id)\">\r\n              {{ product.productname }}\r\n            </ion-item>\r\n          </ion-list>\r\n          <!-- Display message if no products found -->\r\n          <div *ngIf=\"products.length === 0\" class=\"no-products-message\">\r\n            <p>No products found.</p>\r\n          </div>\r\n        </div>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row *ngIf=\"products.length === 0\">\r\n      <ion-col size=\"12\">\r\n        <p>No products available.</p>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n\r\n  <form [formGroup]=\"productForm\" *ngIf=\"selectedProductId\">\r\n    <ion-item>\r\n      <!-- <ion-label>Image:</ion-label> -->\r\n      <!-- Use ion-img to display the image -->\r\n      <ion-img [src]=\"productForm.get('image_product')?.value\"></ion-img>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-label>Product Name : </ion-label>\r\n      <ion-input formControlName=\"productname\" readonly></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-label>Reference : </ion-label>\r\n      <ion-input formControlName=\"reference\" readonly></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-label>Price : </ion-label>\r\n      <ion-input formControlName=\"price\" type=\"number\" readonly></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-label>Description : </ion-label>\r\n      <ion-textarea formControlName=\"description\" readonly></ion-textarea>\r\n    </ion-item>\r\n    \r\n  </form>\r\n  \r\n\r\n  <!-- Fab button -->\r\n  <ion-fab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\r\n    <ion-fab-button (click)=\"openProductModalAddPage()\">\r\n      <ion-icon name=\"add\"></ion-icon>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n</ion-content>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}